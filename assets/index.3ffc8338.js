import{b8 as A,j as i,U as y,a,S as s,T as U,bN as Y,H as S,au as f,ah as L,bO as O,as as T,bh as M,af as j,aq as q,k as G,r as Q,aH as V,aI as I,aP as J,b2 as v,C as d,az as K,f as X,ay as Z,l as $,bP as ee,A as ae,aS as oe,bL as re,B as ie,b as te}from"./index.b3b82eb3.js";import{H as C}from"./Head.663b461a.js";import{I as ne,A as se,L as k}from"./index.1677c1d2.js";import{P as z}from"./permission-check.51974c0f.js";import{u as R,a as le,b as ce}from"./profile.validation.ad7e7eae.js";import{p as Le,c as Ie,b as ze}from"./profile.validation.ad7e7eae.js";import{F as E,C as de}from"./form.5084ebc2.js";import{F as me}from"./file-upload.7eb0e642.js";import{u as N,c as pe}from"./confirm-password.validation.fea8be59.js";import{u as fe}from"./change-password.ad8a8492.js";import"./slicedToArray.dcf7c84f.js";const Se=()=>{const{user:e,fullName:o,isLoading:m}=A(),{t}=R(["common","userProfile","auth"]),l=e?[{label:t("common:info.full_name"),text:o},{label:t("common:info.date_of_birth"),text:e==null?void 0:e.birthday},{label:t("common:info.gender"),text:String(e==null?void 0:e.gender)},{label:t("common:info.email_address"),text:e==null?void 0:e.email},{label:t("common:info.phone_number"),text:e==null?void 0:e.phone}].filter(Boolean):[];return e?i(y,{children:[a(C,{title:t("userProfile:profile")}),i(s,{direction:{base:"column-reverse",xl:"row"},alignItems:"flex-start",spacing:"24px",w:"100%",children:[i(s,{w:"full",spacing:"24px",maxW:{base:"full",xl:"70%"},children:[i(s,{padding:"24px",borderRadius:"8px",direction:"column",spacing:"24px",bg:"white",children:[a(U,{sx:{fontWeight:"700",fontSize:"20px",lineHeight:"27px",paddingBottom:"24px",borderBottom:"1px solid",borderColor:"neutral.500"},children:t("userProfile:profile_information")}),a(ne,{infoData:l}),a(s,{})]}),a(z,{allowedRoles:Y,children:i(s,{bg:"white",p:"24px",rounded:"8px",spacing:"24px",children:[a(S,{variant:"title",children:t("userProfile:security_privacy")}),a(f,{as:L,to:"change-password",variant:"ghost",size:"lg",leftIcon:a(O,{}),w:"200px",children:t("auth:change_password.change_password")})]})})]}),a(se,{isLoading:!m,avatar:e==null?void 0:e.avatar,title:o,location:"",roleType:e==null?void 0:e.role,children:a(z,{allowedRoles:[T.Admin],children:a(f,{as:L,to:"edit",size:"lg",variant:"ghost",leftIcon:a(M,{}),children:t("userProfile:edit_profile")})})})]})]}):null},Ce=()=>{const{t:e}=R(["userProfile","common"]),{user:o}=A(),m=j(),t=q(),l=N({schema:ce}),h=l.getValues("avatar")instanceof File?"":l.getValues("avatar"),{formState:p,register:c,reset:u,control:g,isDirtyField:W,getValues:B}=l,{errors:r,isSubmitting:H,defaultValues:w}=p,b=le(),x=G();function D(){var _;const n=B();((o==null?void 0:o.avatar)===n.avatar?null:n.avatar)||delete n.avatar,b.mutate({...n,id:Number(o==null?void 0:o.user_id),birthday:I({date:oe(n.birthday),format:"YYYY-MM-DD"})},{onSuccess(P){t(-1),m.setQueryData([re],P.data.user_info)}}),(_=x.current)==null||_.hide()}return Q.exports.useEffect(()=>{o&&u(V({...o,birthday:I({date:o.birthday?o.birthday:new Date,format:"YYYY-MM-DD"}),gender:J[o.gender],zip_code:Number(o.zip_code)}))},[o,u]),i(y,{children:[a(C,{title:e("userProfile:profile_edit")}),a(E,{form:l,onSubmit:D,children:i(s,{direction:{base:"column-reverse",xl:"row"},spacing:"24px",w:"100%",alignItems:"flex-start",children:[a(k,{w:{base:"full",xl:"70%"},children:i(s,{direction:"column",spacing:"24px",children:[a(S,{variant:"title",mt:"12px",children:e("userProfile:profile_information")}),i(s,{children:[i(v,{columns:{base:1,md:2},spacing:{base:2,md:6},children:[a(d,{label:e("common:info.first_name"),placeholder:e("common:info.form.enter_first_name"),isRequired:!0,registration:c("first_name"),error:r==null?void 0:r.first_name}),a(d,{label:e("common:info.middle_name"),placeholder:e("common:info.form.enter_middle_name"),isRequired:!0,registration:c("middle_name"),error:r==null?void 0:r.middle_name})]}),i(v,{columns:{base:1,md:2},spacing:{base:2,md:6},children:[a(d,{label:e("common:info.last_name"),placeholder:e("common:info.form.enter_last_name"),isRequired:!0,registration:c("last_name"),error:r==null?void 0:r.last_name}),a(de,{name:"phone",control:g,render:({field:{value:n,onChange:F,..._}})=>a(d,{label:e("common:info.phone_number"),placeholder:"012-345-6789",isRequired:!0,error:r==null?void 0:r.phone,value:n!=null?n:"",maxLength:12,onChange:P=>{F(K(P.target.value))},..._})})]}),a(d,{label:e("common:info.email"),placeholder:e("common:info.form.enter_email"),registration:c("email"),error:r==null?void 0:r.email,isDisabled:!0}),i(v,{columns:{base:1,md:2},spacing:{base:2,md:6},alignItems:"start",children:[a(d,{label:e("common:info.date_of_birth"),placeholder:e("common:info.form.enter_date"),isRequired:!0,type:"date",registration:c("birthday"),error:r==null?void 0:r.birthday}),a(X,{options:Z,label:e("common:info.gender"),isRequired:!0,placeholder:w!=null&&w.gender?void 0:e("common:please_select"),registration:c("gender",{valueAsNumber:!0}),error:r.gender})]})]}),i(s,{align:"center",children:[a(f,{bg:"primary",size:"lg",color:"white",w:"348px",maxW:"100%",type:"button",isDisabled:!W||b.isLoading,onClick:()=>{var n;Object.keys(r).length||(n=x.current)==null||n.show()},children:e("common:save_changes")}),a($,{ref:x,title:e("userProfile:change_profile"),textConfirm:e("common:save_changes"),type:"info",isLoading:b.isLoading,isDone:b.isSuccess,onHandleConfirm:D})]})]})}),a(me,{initUrl:h instanceof File?void 0:h,control:g,name:"avatar",error:r==null?void 0:r.avatar,trigger:()=>a(f,{color:"secondary",fontWeight:700,size:"lg",variant:"ghost",leftIcon:a(ee,{}),isDisabled:H,children:e("userProfile:edit.upload_new_picture")}),stackProps:{direction:"column",align:"flex-start",spacing:4},controlProps:{bg:"white",rounded:"8px",p:"32px",w:{base:"full",xl:"30%"}},labelProps:{w:"full"},children:n=>i(s,{spacing:4,w:"full",children:[a(ae,{src:n||(o==null?void 0:o.avatar),boxSize:20}),a(U,{sx:{fontWeight:"700",fontSize:"20px",lineHeight:"27px"},children:e("userProfile:profile_update")})]})})]})})]})},Re=()=>{const e=N({schema:pe}),{t:o}=R(["common","auth","userProfile"]),m=q(),{formState:t,register:l,reset:h}=e,{errors:p}=t,c=fe();function u(g){c.mutate(g,{onSuccess(){h(),m(te.PROFILE)}})}return i(y,{children:[a(C,{title:o("auth:change_password.change_password")}),a(ie,{w:"540px",mx:"auto",maxW:"100%",children:a(k,{children:a(E,{form:e,onSubmit:u,children:i(s,{direction:"column",spacing:6,maxW:"100%",children:[a(S,{variant:"title",children:o("auth:change_password.change_password")}),a(d,{label:o("auth:current_password"),type:"password",size:"lg",isRequired:!0,placeholder:o("auth:form.enter_your_current_password"),registration:l("current_password"),error:p.current_password}),a(d,{label:o("auth:new_password"),size:"lg",type:"password",isRequired:!0,placeholder:o("auth:form.enter_your_new_password"),registration:l("password"),error:p.password}),a(d,{label:o("auth:confirm_new_password"),type:"password",size:"lg",isRequired:!0,placeholder:o("auth:confirm_new_password"),registration:l("password_confirmation"),error:p.password_confirmation}),a(s,{align:"center",children:a(f,{bg:"primary",size:"lg",color:"white",w:"348px",maxW:"100%",type:"submit",isLoading:c.isLoading,isDisabled:c.isLoading,children:o("auth:change_password.change_password")})})]})})})})]})};export{Re as ChangePasswordPage,Ce as EditProfilePage,Se as ProfilePage,Le as profileCreateFormSchema,Ie as profileFormSchemaBase,ze as profileUpdateFormSchema};
