import{j as l,B as h,a as e,ao as H,ap as D,ae as w,aq as S,af as q,ab as C,bK as M,bL as z,b as c,ac as f,as as W,bM as x,ad as _,b8 as j,r as U,F as I,bj as v,N as G,U as y,S as d,C as m,au as b,ag as Q,ah as A,bJ as B}from"./index.b3b82eb3.js";import{H as L}from"./Head.663b461a.js";import{F as R}from"./form.5084ebc2.js";import{u as E,c as $,l as K,m as J,a as V,d as X}from"./confirm-password.validation.fea8be59.js";import{u as Y}from"./change-password.ad8a8492.js";import{C as Z}from"./index.esm.2b6ea95a.js";import{C as k}from"./chakra-link.98b662c1.js";function P({description:s,title:i,children:o}){return l(h,{w:"full",children:[e(h,{as:"h1",fontSize:"36px",color:"neutral.100",fontWeight:800,children:i}),e(h,{as:"p",fontSize:"16px",color:"neutral.300",mt:4,mb:8,children:s}),o]})}const O="users/set-last-login",ee=()=>D(w({url:O,method:"GET"}));function se({configs:s}={}){const{data:i,...o}=H({...s,queryFn:()=>ee(),queryKey:[O]});return{message:i==null?void 0:i.message,...o}}const oe="login",te=s=>w({url:oe,method:"POST",data:s}),ie=({config:s}={})=>{const i=S(),o=q(),{refetch:r}=se({configs:{enabled:!1}});return C({mutationFn:te,onSuccess:t=>{var n,a;if(t.success){if(M(t.data.token),o.setQueryData([z],t.data.user_info),(a=(n=t.data)==null?void 0:n.user_info)==null?void 0:a.is_first_login){i(`${c.AUTH}${c.FIRST_LOGIN}`);return}f("SUCCESS",t.data.message),t.data.user_info.role_type===W.Admin?i(c.HOME):i(c.PATIENTS_MANAGEMENT),r()}else x()},onError(t){f("ERROR",t==null?void 0:t.message)},...s})},re="reset-password",ne=s=>w({url:re,method:"POST",data:s}),ae=({config:s}={})=>{const i=S();return C({mutationFn:ne,onSuccess(o){var r,t;o.success&&((r=o.data)!=null&&r.message&&f("SUCCESS",(t=o.data)==null?void 0:t.message),i(c.AUTH))},onError:o=>{_(o)},...s})},ce="forgot-password",le=s=>w({url:ce,method:"POST",data:s}),ue=({config:s}={})=>C({mutationFn:le,onSuccess(i){var o,r;i.success&&f("SUCCESS",(r=(o=i.data)==null?void 0:o.message)!=null?r:"Link verify sent")},onError:i=>{_(i)},...s});function Se(){const s=E({schema:$,options:{mode:"onSubmit"}}),{formState:i,register:o}=s,{errors:r}=i,t=S(),n=Y(),a=q();function u(F){n.mutate(F,{onSuccess:()=>{t(c.AUTH),x(),a.setQueryData([z],null)}})}const{isFirstLogin:g,isLoading:p}=j();return U.exports.useEffect(()=>()=>{g||x()},[g]),p?e(I,{position:"fixed",inset:0,h:"full",w:"full",alignItems:"center",justifyContent:"center",children:e(v,{size:"xl"})}):!g&&!p?e(G,{to:c.AUTH}):l(y,{children:[e(L,{title:"First Login page"}),e(P,{title:"Create password",description:"This is your first time sign in. Please create a new password to continue",children:e(R,{form:s,onSubmit:u,children:l(d,{direction:"column",spacing:6,children:[e(m,{label:"New password",size:"lg",type:"password",isRequired:!0,placeholder:"Enter your password",registration:o("password"),error:r.password}),e(m,{label:"Confirm New Password",type:"password",size:"lg",isRequired:!0,placeholder:"Enter your password again",registration:o("password_confirmation"),error:r.password_confirmation}),e(b,{bg:"primary",size:"lg",color:"white",type:"submit",isLoading:n.isLoading,isDisabled:n.isLoading,children:"Continue"})]})})})]})}function ye(){const s=E({schema:K,options:{mode:"onSubmit"}}),{formState:i,register:o}=s,{errors:r}=i,t=ie();function n(a){t.mutate(a)}return l(y,{children:[e(L,{title:"Login"}),e(P,{title:"Sign in",description:"Access to your account",children:e(R,{form:s,onSubmit:n,children:l(d,{direction:"column",spacing:6,children:[e(m,{label:"Email",size:"lg",isRequired:!0,placeholder:"Enter your email",registration:o("email"),error:r.email}),e(m,{label:"Password",type:"password",size:"lg",isRequired:!0,placeholder:"Enter your password",registration:o("password"),error:r.password}),l(d,{direction:"row",justifyContent:"space-between",align:"center",children:[e(Z,{size:"lg",defaultChecked:!0,textColor:"secondary",isDisabled:t.isLoading,children:e(h,{as:"span",sx:{fontWeight:"500",fontSize:{base:"14px",sm:"16px"},lineHeight:"22px"},children:"Remember me"})}),e(Q,{to:t.isLoading?"":"/auth/forgot-password",as:A,color:"primary",fontWeight:700,fontSize:{base:"14px",sm:"16px"},children:"Forgot your password?"})]}),e(b,{bg:"primary",size:"lg",color:"white",type:"submit",isLoading:t.isLoading,isDisabled:t.isLoading,children:"Sign in"})]})})})]})}function be(){const s=E({schema:J.object({email:V()}),options:{mode:"onSubmit"}}),{register:i,formState:o}=s,{errors:r,isSubmitting:t}=o,n=ue();function a(u){n.mutate(u)}return l(y,{children:[e(L,{title:"Forgot password"}),e(P,{title:"Forgot password",description:"Please enter your registered email.We\u2019ll send you the instruction to reset your password",children:e(R,{form:s,onSubmit:a,children:l(d,{direction:"column",spacing:5,children:[e(m,{label:"Email",size:"lg",isRequired:!0,placeholder:"Enter your email",registration:i("email"),error:r.email}),e(d,{direction:"row",justify:"flex-end",align:"center",children:e(k,{to:n.isLoading?"":c.AUTH,as:A,color:"primary",textProps:{color:"primary",fontSize:{base:"14px",sm:"16px"}},fontWeight:700,children:"Return to login"})}),e(b,{bg:"primary",size:"lg",color:"white",isLoading:t||n.isLoading,isDisabled:t||n.isLoading,type:"submit",children:"Send request"})]})})})]})}const T=function(s){return new Map(s.slice(1).split("&").map(o=>o.split("=")))};function Le(){const s=S(),i=B(),o=T(i.search).get("token"),r=T(i.search).get("email"),t=E({schema:X,options:{mode:"onSubmit"}}),{setValue:n,formState:a,register:u}=t,{errors:g}=a,p=ae();function F(N){p.mutate(N)}return U.exports.useEffect(()=>{if(!o||!r){s(c.AUTH);return}n("email",r),n("token",o)},[o,r,n,s]),l(y,{children:[e(L,{title:"Reset password"}),e(P,{title:"Reset password",description:"",children:e(R,{form:t,onSubmit:F,children:l(d,{direction:"column",spacing:6,children:[e(m,{label:"New password",size:"lg",isRequired:!0,placeholder:"Enter your password",type:"password",registration:u("password"),error:g.password}),e(m,{label:"Confirm New Password",type:"password",size:"lg",isRequired:!0,placeholder:"Enter your password again",registration:u("password_confirmation"),error:g.password_confirmation}),e(d,{direction:"row",justify:"flex-end",align:"center",children:e(k,{to:c.AUTH,as:A,color:"primary",textProps:{color:"primary",fontSize:{base:"14px",sm:"16px"}},fontWeight:700,children:"Return to login"})}),e(b,{bg:"primary",size:"lg",color:"white",type:"submit",isLoading:p.isLoading,isDisabled:p.isLoading,children:"Continue"})]})})})]})}export{Se as FirstLoginPage,be as ForgotPasswordPage,ye as LoginPage,Le as ResetPasswordPage,T as parseQueryString};
