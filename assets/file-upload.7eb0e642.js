import{R as i,r as m,j as v,x as I,a as n,y as T,S,T as M,v as _,z,D as B,E as D,G}from"./index.b3b82eb3.js";import{u as O,a as A}from"./form.5084ebc2.js";const H=({name:j,initUrl:x="",control:y,children:o,isRequired:c=!1,error:a,controlProps:C,labelProps:E,stackProps:F,trigger:R,...l})=>{const u=i.useRef(),{field:{ref:P,value:q,...f}}=O({name:j,control:y,rules:{required:c}}),b=!!a,[s,p]=m.exports.useState(x),{setError:r,clearErrors:g}=A();m.exports.useEffect(()=>()=>{window.URL.revokeObjectURL(s)},[s]);const w=i.cloneElement(R(s),{onClick(){var e;(e=u.current)==null||e.click()}}),L=o?i.cloneElement(o(s),{onClick:e=>{e==null||e.preventDefault()}}):void 0;return v(I,{isInvalid:l.isInvalid,isRequired:c,...C,children:[n(T,{...E,children:v(S,{direction:"row",align:"center",spacing:4,...F,onClick:e=>e.preventDefault(),children:[L,w,b&&n(M,{color:"red.500",children:a==null?void 0:a.message})]})}),n(_,{children:n(z,{ref:u,type:"file",accept:"image/*",hidden:!0,...l,...f,onChange:e=>{var d,h;const t=(h=(d=e.target)==null?void 0:d.files)==null?void 0:h[0];if(!!t){if(t.size>=B){r("avatar",{message:"Max size image 5MB"},{shouldFocus:!0});return}if(!t.name.match(D)){r("avatar",{message:"The file must be a list of type: jpeg, png, jpg, heic, heif, jfif."},{shouldFocus:!0});return}if(t.type.includes("heic")||t.type.includes("heif")){G({blob:t,toType:"image/jpeg",quality:0}).then(U=>{const k=U;p(URL.createObjectURL(k)),g("avatar")},()=>{r("avatar",{message:"Something went wrong! Try again"},{shouldFocus:!0})});return}p(URL.createObjectURL(t)),g("avatar"),f.onChange(t)}}})})]})};export{H as F};
