import{aq as B,ao as J,b as N,ad as V,r as h,ap as X,ae as Z,u as Y,a as o,T as _,j as l,S as g,A as q,F as T,at as L,ar as ee,af as oe,i as U,k as te,U as se,n as R,as as c,B as $,bF as re,au as A,M as w,bh as ne,aH as ae,aI as Q,aP as ie,l as de,aS as le}from"./index.b3b82eb3.js";import{C as f}from"./clinic-team-endpoint.08333932.js";import{u as ue}from"./confirm-password.validation.fea8be59.js";import{u as me,A as pe,C as ce,a as fe}from"./clinic-team-form.84be3c06.js";import{C as ge}from"./chakra-link.98b662c1.js";import{T as he}from"./table.1bced37e.js";import{u as G,a as _e}from"./profile.validation.ad7e7eae.js";import{A as be,D as Ae}from"./assign-icon.612a5b8e.js";import{H as Ce}from"./Head.663b461a.js";import{u as ye,P as z}from"./patient-endpoint.36464126.js";import{L as Pe,I as Le,A as Ne}from"./index.1677c1d2.js";import{F as xe}from"./form.5084ebc2.js";import{T as Ie}from"./index.d4b9fca0.js";import"./file-upload.7eb0e642.js";import"./index.esm.2b6ea95a.js";import"./popper.824c9986.js";import"./slicedToArray.dcf7c84f.js";function Se(t){return X(Z({url:f.DETAIL,method:"get",params:{user_id:t}}))}function O({configs:t,id:a,shouldNavigateNotFound:i=!1}){const e=B(),{data:s,...u}=J({enabled:!!a,...t,queryFn:()=>Se(a),onError(n){((n==null?void 0:n.code)===404||(n==null?void 0:n.statusCode)===404)&&i?e(N.NOT_FOUND):V(n)},queryKey:[f.DETAIL,a]}),m=h.exports.useMemo(()=>s==null?void 0:s.user,[s==null?void 0:s.user]),p=h.exports.useMemo(()=>s==null?void 0:s.patients,[s==null?void 0:s.patients]);return{clinicTeamDetail:m,patientsOfClinicTeam:p,totalPatients:s==null?void 0:s.total_patient,...u,isLoading:u.isLoading&&u.fetchStatus!=="idle"}}const Ee=()=>{const{id:t}=Y(),{t:a}=G(["common","clinic"]),{totalPatients:i,patientsOfClinicTeam:e,isLoading:s,isError:u}=O({id:Number(t)}),m=h.exports.useMemo(()=>[{header:"User",columns:[{key:"special_id",title:"ID",Cell({special_id:p}){return o(_,{textAlign:"left",children:p})}},{key:"avatar",title:a("common:table.patient").toUpperCase(),Cell:({id:p,avatar:n,phone:y,...d})=>l(g,{direction:"row",cursor:"pointer",children:[o(q,{src:n,boxSize:"40px",rounded:"full"}),l(T,{direction:"column",children:[o(ge,{to:`${N.PATIENTS_MANAGEMENT}/${p}`,children:L({firstName:d==null?void 0:d.first_name,middleName:d==null?void 0:d.middle_name,lastName:d==null?void 0:d.last_name})}),o(_,{color:"primary",children:y})]})]})},{key:"gender",title:a("common:info.gender").toUpperCase()},{key:"birthday",title:a("common:info.d_o_b").toUpperCase()},{key:"type",title:a("common:table.group").toUpperCase(),Cell({type:p}){return o(_,{color:"primary",textAlign:"left",children:ee[p]})}}]}],[a]);return o(he,{currentPage:1,perPage:i,data:e!=null?e:[],groupColumns:m,totalCount:i,isLoading:s,error:u,hasNoPaginate:!0})},He=()=>{var k,F;const{t}=G(["clinic","common"]),{id:a}=Y(),i=oe(),{clinicTeamDetail:e,totalPatients:s,patientsOfClinicTeam:u,isLoading:m,refetch:p}=O({id:Number(a),shouldNavigateNotFound:!0}),n=L({firstName:e==null?void 0:e.first_name,middleName:e==null?void 0:e.middle_name,lastName:e==null?void 0:e.last_name}),y=B(),d=U(),x=te(),I=ue({schema:fe}),{reset:W,isDirtyField:j}=I,b=_e(),S=ye();function H(r){b.mutate({...r,id:e==null?void 0:e.user_id,birthday:Q({date:le(r.birthday),format:"YYYY-MM-DD"})},{onSuccess(){i.refetchQueries([f.LIST]),i.refetchQueries([z.DETAIL]),p()}})}const P=U(),C=me(),[E,M]=h.exports.useState([]),v=h.exports.useMemo(()=>E,[E]),K=h.exports.useCallback(M,[M]);function D(){!(e!=null&&e.user_id)||C.mutate({user_id:e==null?void 0:e.user_id,patient:v.length?v.map(({id:r})=>r):[]},{onSuccess(){i.refetchQueries([f.DETAIL,e.user_id]),i.refetchQueries([f.LIST_PATIENT_ASSIGN_CLINIC])}})}return l(se,{children:[o(Ce,{title:n}),l(g,{direction:{base:"column-reverse",lg:"row"},spacing:6,align:"flex-start",children:[o(Pe,{maxW:{base:"full",lg:"70%"},children:o(Ie,{tabData:[{title:t("clinic:detail.doctor_nurse_info"),children:o(R,{children:o(R.Card,{isLoaded:!m,noOfLines:4,children:o(Le,{infoData:[{label:`${t("common:info.full_name")}`,text:n},{label:`${t("common:info.role")}`,text:e!=null&&e.role_type?c[e==null?void 0:e.role_type]:""},{label:`${t("common:info.gender")}`,text:e!=null&&e.gender?String(e==null?void 0:e.gender):""},{label:`${t("common:info.email_address")}`,text:e==null?void 0:e.email},{label:`${t("common:info.phone_number")}`,text:e==null?void 0:e.phone},{label:`${t("common:info.hospital")}`,text:(k=e==null?void 0:e.hospital)!=null?k:""}]})})})},((e==null?void 0:e.role_type)===c.Doctor||(e==null?void 0:e.role_type)===c.ARNP)&&{title:t("clinic:detail.assigned_patient"),children:o(Ee,{})}].filter(Boolean)})}),o(Ne,{isLoading:!m,avatar:e==null?void 0:e.avatar,location:"",title:n,roleType:e!=null&&e.role_type?c[e==null?void 0:e.role_type]:"",children:l(g,{pt:4,borderTop:"1px",borderColor:"neutral.500",children:[((e==null?void 0:e.role_type)===c.Doctor||(e==null?void 0:e.role_type)===c.ARNP)&&l($,{children:[o(_,{color:"neutral.300",children:"Assigned Patient"}),l(g,{mt:4,direction:"row",spacing:10,align:"center",children:[l(g,{direction:"row",children:[o(re,{boxSize:"40px",spacing:"-1.3rem",children:!!s&&(u==null?void 0:u.slice(0,4).map(r=>o(q,{boxSize:10,name:L({firstName:r.first_name,middleName:r.middle_name,lastName:r.last_name}),src:r.avatar},r.id)))}),!s&&o(_,{children:"Unassigned"})]}),!!s&&o(_,{children:`${s} ${t("common:patients")}`})]})]}),l(g,{spacing:4,pt:4,children:[((e==null?void 0:e.role_type)===c.Doctor||(e==null?void 0:e.role_type)===c.ARNP)&&l(A,{size:"lg",isDisabled:m,leftIcon:o(be,{}),onClick:()=>{var r;(r=P.current)==null||r.openModal()},children:[t("clinic:detail.assign_patient_to_doctor"),o(w,{ref:P,title:t("clinic:detail.assign_patient_to_doctor"),isDone:C.isSuccess,renderFooter:()=>o(A,{w:"348px",size:"lg",type:"button",isLoading:C.isLoading,isDisabled:C.isLoading,onClick:r=>{r.preventDefault(),D()},children:t("common:submit")}),children:o($,{w:"full",pt:4,children:o(pe,{enabledGetUsers:(F=P.current)==null?void 0:F.isOpen,limitSelect:5,userId:Number(e==null?void 0:e.user_id),onAssignIds:K})})})]}),l(A,{size:"lg",variant:"ghost",isDisabled:m,leftIcon:o(ne,{}),onClick:()=>{var r;e&&W(ae({...e,birthday:Q({date:e.birthday,format:"YYYY-MM-DD"}),gender:e!=null&&e.gender?ie[e.gender]:void 0,role:e==null?void 0:e.role_type})),(r=d.current)==null||r.openModal()},children:[t("clinic:detail.edit_doctor_nurse_profile"),e&&o(w,{ref:d,isDone:b.isSuccess,title:t("clinic:detail.update_doctor/nurse"),renderFooter:()=>o(A,{w:"348px",size:"lg",type:"submit",form:"update-clinic",isLoading:b.isLoading,isDisabled:!j||b.isLoading,children:t("common:save")}),onBeforeClose:()=>{b.reset()},children:o(xe,{form:I,id:"update-clinic",onSubmit:H,children:o(ce,{})})})]}),l(A,{leftIcon:o(Ae,{}),size:"lg",isDisabled:m,variant:"ghost",onClick:()=>{var r;return(r=x.current)==null?void 0:r.show()},children:[t("clinic:detail.delete_doctor/nurse"),e&&o(de,{ref:x,isLoading:S.isLoading,onHandleConfirm:()=>S.mutate(e==null?void 0:e.user_id,{onSuccess(){y(N.CLINIC_TEAM),i.refetchQueries([f.LIST]),i.removeQueries([f.DETAIL,a]),i.refetchQueries([z.DETAIL])}})})]})]})]})})]})]})};export{He as ClinicTeamDetailPage};
