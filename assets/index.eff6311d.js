import{af as Le,ab as Ft,ac as qt,ad as pt,ae as Pe,ao as ct,r as I,ap as lt,aq as Wi,b as ft,ar as Ge,R as mt,as as U,at as Ee,a as l,S as R,j as E,n as Qe,g as kn,U as Se,T as q,A as $e,au as re,av as br,aw as Tr,ax as J,C as me,f as kt,ay as Er,az as on,h as gi,H as at,aA as yi,aB as vi,aC as Sr,aD as _i,aE as xr,B as He,aF as kr,aG as Cr,aH as Pt,aI as ye,F as en,aJ as Un,k as Nt,i as Rt,aK as Vi,aL as Cn,aM as wr,aN as Ar,aO as Pr,aP as Xi,aQ as ji,aR as Qi,M as Ot,l as It,aS as C,aT as Nr,aU as ee,aV as wn,aW as Rr,aX as Or,aY as tn,aZ as bi,a_ as ie,a$ as Ir,b0 as ge,b1 as Lr,b2 as Mr,b3 as Ki,b4 as $i,b5 as Gi,b6 as Zi,b7 as Dr,b8 as Br,d as Ji,b9 as Fr,ba as qr,bb as zr,bc as Yr,bd as Ur,u as Hr,be as Wr,bf as Vr,bg as Xr,bh as jr}from"./index.b3b82eb3.js";import{P as Y,C as Qr,u as es}from"./patient-endpoint.36464126.js";import{u as hn,P as An,T as Kr}from"./table.1bced37e.js";import{C as an}from"./clinic-team-endpoint.08333932.js";import{e as $r,m as ot,r as Ti,g as ts,a as Gr,u as Lt}from"./confirm-password.validation.fea8be59.js";import{p as Zr,u as Je,a as ns}from"./profile.validation.ad7e7eae.js";import{T as is,a as Jr,b as eo,c as Ei,d as to,e as Si}from"./index.d4b9fca0.js";import{a as ss,C as St,F as Mt}from"./form.5084ebc2.js";import{F as no}from"./file-upload.7eb0e642.js";import{u as so,A as ro,a as oo,b as rs,c as ao}from"./additional-feature.294219f4.js";import{M as co}from"./modal-base.91f8d918.js";import{P as Ie}from"./permission-check.51974c0f.js";import{Q as lo}from"./quill-editor.cdca5dd9.js";import{H as os}from"./Head.663b461a.js";import{C as uo,M as ho}from"./change-status-user.9246f232.js";import{C as Ct}from"./chakra-link.98b662c1.js";import{e as et,c as ae,v as cn,s as xi,C as fo,a as po,L as mo,P as go,b as yo,p as vo,d as _o,i as bo,f as To,g as Eo,h as So}from"./custom-calender-date-range.bdb82f2b.js";import{H as xo}from"./html-parser.6d540346.js";import{A as as,D as ko}from"./assign-icon.612a5b8e.js";import{L as Co,I as ki,A as wo}from"./index.1677c1d2.js";import"./index.esm.2b6ea95a.js";import"./popper.824c9986.js";import"./slicedToArray.dcf7c84f.js";const Ao=n=>Pe({url:Y.CREATE,method:"POST",data:n}),Po=({configs:n}={})=>{const e=Le();return Ft({mutationFn:Ao,onSuccess(t){var i,r;!t.success||(i=t.data)!=null&&i.message&&(qt("SUCCESS",(r=t.data)==null?void 0:r.message),e.refetchQueries([Y.LIST]))},onError:t=>{pt(t)},...n})};function No(n){return lt(Pe({url:Y.LIST,method:"get",params:n}))}function Ro({configs:n}={}){var v,_;const e=Le(),{queryParams:t,...i}=hn(),{data:r,...s}=ct({...n,queryFn:()=>No(t),queryKey:[Y.LIST,t]}),c=I.exports.useMemo(()=>{var b;return(b=r==null?void 0:r.patients)==null?void 0:b.data},[(v=r==null?void 0:r.patients)==null?void 0:v.data]),p=I.exports.useMemo(()=>{var b;return(b=r==null?void 0:r.patients)==null?void 0:b.paging},[(_=r==null?void 0:r.patients)==null?void 0:_.paging]);function f(){e.refetchQueries([Y.LIST,t])}return{patientsList:c,patientsPaging:p,queryParams:t,invalidateQueryPatientList:f,...i,...s}}function Oo(n){return lt(Pe({url:Y.DETAIL,method:"get",params:{id:n}}))}function cs({configs:n,id:e,shouldNavigateNotFound:t=!1}){const i=Wi(),{data:r,...s}=ct({enabled:!!e,...n,queryFn:()=>Oo(e),onError(f){((f==null?void 0:f.code)===404||(f==null?void 0:f.statusCode)===404)&&t?i(ft.NOT_FOUND):pt(f)},queryKey:[Y.DETAIL,e]}),c=I.exports.useMemo(()=>r==null?void 0:r.patient,[r==null?void 0:r.patient]),p=I.exports.useMemo(()=>r==null?void 0:r.notes,[r==null?void 0:r.notes]);return{patientDetail:c,patientNotes:p,...s,isLoading:s.isLoading&&s.fetchStatus!=="idle"}}const Io=n=>Pe({url:Y.ASSIGN_DOCTOR_TO_PATIENT,method:"POST",data:n}),ls=({configs:n}={})=>{const e=Le();return Ft({mutationFn:Io,onSuccess:async(t,i)=>{var r,s;!t.success||((r=t.data)!=null&&r.message&&qt("SUCCESS",(s=t.data)==null?void 0:s.message),e.refetchQueries([Y.LIST]),await e.refetchQueries([Y.DETAIL,i.patient_id]),e.refetchQueries([an.DETAIL]),e.refetchQueries([Y.DOCTOR_ARPN_LIST_ASSIGN_PATIENT]))},onError:t=>{pt(t)},...n})};function dt(n){return`patients/${n}/note`}function Lo(n,e){return lt(Pe({url:dt(e),method:"get",params:n}))}function Mo({configs:n,id:e}){const t=Le(),{queryParams:i,...r}=hn({per_page:5}),{data:s,...c}=ct({...n,queryFn:()=>Lo(i,e),queryKey:[dt(e),i]}),p=I.exports.useMemo(()=>(s==null?void 0:s.notes.data)||[],[s==null?void 0:s.notes.data]),f=I.exports.useMemo(()=>s==null?void 0:s.notes.paging,[s==null?void 0:s.notes.paging]);function v(){t.refetchQueries([dt(e),i])}return{notesList:p,notesPaging:f,queryParams:i,invalidateQueryListNotes:v,...r,...c}}const Do=n=>Pe({url:Y.CREATE_NOTE,method:"POST",data:n}),us=({configs:n}={})=>{const e=Le();return Ft({mutationFn:Do,onSuccess(t,i){var r,s;!t.success||(r=t.data)!=null&&r.message&&(qt("SUCCESS",(s=t.data)==null?void 0:s.message),e.refetchQueries([dt(i.patient_id)]))},onError:t=>{pt(t)},...n})},Bo=({noteId:n})=>Pe({url:`${Y.DELETE_NOTE}/${n}/delete`,method:"DELETE"}),Fo=({configs:n}={})=>{const e=Le();return Ft({mutationFn:Bo,onSuccess(t,i){var r,s;!t.success||(r=t.data)!=null&&r.message&&(qt("SUCCESS",(s=t.data)==null?void 0:s.message),e.refetchQueries([dt(i.patientId)]))},onError:t=>{pt(t)},...n})},qo=({patientId:n,...e})=>Pe({url:Y.UPDATE_NOTE,method:"POST",data:e}),zo=({configs:n}={})=>{const e=Le();return Ft({mutationFn:qo,onSuccess(t,i){var r,s;!t.success||(r=t.data)!=null&&r.message&&(qt("SUCCESS",(s=t.data)==null?void 0:s.message),e.refetchQueries([dt(i.patientId)]))},onError:t=>{pt(t)},...n})};function Yo(n){return lt(Pe({url:Y.DOCTOR_ARPN_LIST_ASSIGN_PATIENT,method:"get",params:n}))}function Ci({patientId:n,configs:e,role:t}){var b,k;const i=Le(),{queryParams:r,...s}=hn(),{data:c,...p}=ct({...e,queryFn:()=>Yo({patient_id:n,role:t,...r}),queryKey:[Y.DOCTOR_ARPN_LIST_ASSIGN_PATIENT,n,t,r]}),f=I.exports.useMemo(()=>{var T;return(T=c==null?void 0:c.result)==null?void 0:T.data},[(b=c==null?void 0:c.result)==null?void 0:b.data]),v=I.exports.useMemo(()=>{var T;return(T=c==null?void 0:c.result)==null?void 0:T.paging},[(k=c==null?void 0:c.result)==null?void 0:k.paging]);function _(){i.refetchQueries([Y.DOCTOR_ARPN_LIST_ASSIGN_PATIENT,n,t,r])}return{queryParams:r,doctorARNPListToAssignPatient:f,doctorARNPToAssignPatientPaging:v,...s,...p,invalidateQueryGetDoctorARNPListToAssignPatient:_}}const hs=Zr.extend({email:$r,phone:ot.string({required_error:"Phone is required"}).regex(Ti,"Phone is wrong format"),emergency_name:ts("Emergency name"),emergency_cellphone:ot.string({required_error:"Emergency cellphone is required"}).regex(Ti,"Emergency phone is wrong format"),emergency_email:Gr("Emergency email"),type:ot.nativeEnum(Ge,{invalid_type_error:"Group is required"}),weight:ot.number().optional(),height:ot.number().optional(),device_id:ot.number({required_error:"Device is required",invalid_type_error:"Device is required"})}),fs=hs.partial(),Hn=ot.object({content:ts("Note content")}),Uo=Hn.partial(),wi=({info:n,onSelected:e,...t})=>E(R,{px:"16px",justify:"space-between",direction:"row",...t,children:[E(R,{direction:"row",align:"center",spacing:"12px",children:[l($e,{src:n.avatar}),l(q,{color:"secondary",sx:{fontWeight:"700",fontSize:"14px",lineHeight:"120%"},children:n.name})]}),l(R,{bg:n.checked?"primary":"neutral.300",h:"32px",w:"32px",rounded:"full",cursor:"pointer",align:"center",justify:"center",onClick:()=>e(n),children:l(Qr,{})})]}),ds=mt.memo(({enabledGetUsers:n=!0,patientId:e,patientType:t,onAssignIds:i})=>{var j,z,K,d,S;const{t:r}=Je(["common","patients"]),{doctorARNPListToAssignPatient:s,isLoading:c,queryParams:p,doctorARNPToAssignPatientPaging:f,setQuery:v}=Ci({patientId:e,role:U.Doctor,configs:{enabled:!!e&&n}}),{doctorARNPListToAssignPatient:_,isLoading:b,queryParams:k,doctorARNPToAssignPatientPaging:T,setQuery:P}=Ci({patientId:e,role:U.ARNP,configs:{enabled:!!e&&n&&t===Ge.RPM}}),[w,H]=I.exports.useState(()=>{var y;return(y=s==null?void 0:s.map(m=>{var M,F;return{avatar:m==null?void 0:m.avatar,id:(M=m==null?void 0:m.id)!=null?M:0,name:Ee({firstName:m==null?void 0:m.first_name,middleName:m==null?void 0:m.middle_name,lastName:m==null?void 0:m.last_name}),checked:(F=m.is_assigned)!=null?F:!1,role:U.Doctor}}))!=null?y:[]});I.exports.useEffect(()=>{var y;H((y=s==null?void 0:s.map(m=>{var M,F;return{avatar:m==null?void 0:m.avatar,id:(M=m==null?void 0:m.id)!=null?M:0,name:Ee({firstName:m==null?void 0:m.first_name,middleName:m==null?void 0:m.middle_name,lastName:m==null?void 0:m.last_name}),checked:(F=m.is_assigned)!=null?F:!1,role:U.Doctor}}))!=null?y:[])},[s]);const ne=I.exports.useMemo(()=>w.filter(({checked:y})=>y),[w]),W=y=>{H(m=>m.map(M=>M.id===y.id?{...M,checked:!M.checked}:{...M,checked:!1}))},[V,G]=I.exports.useState((j=_==null?void 0:_.map(y=>{var m,M;return{avatar:y==null?void 0:y.avatar,id:(m=y==null?void 0:y.id)!=null?m:0,name:Ee({firstName:y==null?void 0:y.first_name,middleName:y==null?void 0:y.middle_name,lastName:y==null?void 0:y.last_name}),checked:(M=y.is_assigned)!=null?M:!1,role:U.ARNP}}))!=null?j:[]),$=I.exports.useMemo(()=>V.filter(({checked:y})=>y),[V]);I.exports.useEffect(()=>{var y;G((y=_==null?void 0:_.map(m=>{var M,F;return{avatar:m==null?void 0:m.avatar,id:(M=m==null?void 0:m.id)!=null?M:0,name:Ee({firstName:m==null?void 0:m.first_name,middleName:m==null?void 0:m.middle_name,lastName:m==null?void 0:m.last_name}),checked:(F=m.is_assigned)!=null?F:!1,role:U.ARNP}}))!=null?y:[])},[_]);const Z=y=>{G(m=>m.map(M=>M.id===y.id?{...M,checked:!M.checked}:{...M,checked:!1}))};return I.exports.useEffect(()=>{i&&i([...ne,...$])},[ne,$,i]),l(R,{children:l(is,{tabData:[{title:"Doctor",children:E(Qe.Avatar,{isLoaded:!c,count:5,children:[l(kn,{isDisabled:c,initValue:(p==null?void 0:p.keyword)||void 0,onHandleSearch:y=>{c||v({page:1,keyword:y})}}),E(R,{spacing:"16px",minH:"120px",children:[(w==null?void 0:w.length)&&E(Se,{children:[l(q,{color:"neutral.300",textTransform:"uppercase",sx:{fontWeight:"700",fontSize:"12px",lineHeight:"120%"},pt:"16px",children:r("common:suggestion").toUpperCase()}),l(R,{spacing:"16px",children:w==null?void 0:w.map(y=>l(wi,{info:{avatar:y.avatar,id:y.id,name:y.name,checked:y.checked},opacity:ne.length>0&&!ne.some(m=>m.id===y.id)?".4":1,onSelected:W},y.id))})]}),!(w!=null&&w.length)&&!c&&l(q,{textAlign:"center",fontWeight:"bold",my:"auto",fontSize:20,children:r("common:no_data")})]}),l(R,{direction:"row",mt:"4",justify:"flex-end",align:"center",spacing:"6",px:4,children:l(An,{currentPage:(z=f==null?void 0:f.current_page)!=null?z:1,perPage:Number(f==null?void 0:f.per_page),totalCount:(K=f==null?void 0:f.total)!=null?K:1,onPageChange:y=>v({page:y})})})]})},t===Ge.RPM&&{title:r("patients:form.arnp").toUpperCase(),children:E(Qe.Avatar,{isLoaded:!c,count:5,children:[l(kn,{isDisabled:b,initValue:(k==null?void 0:k.keyword)||void 0,onHandleSearch:y=>{b||P({page:1,keyword:y})}}),E(R,{spacing:"16px",minH:"120px",children:[(V==null?void 0:V.length)&&E(Se,{children:[l(q,{color:"neutral.300",sx:{fontWeight:"700",fontSize:"12px",lineHeight:"120%"},pt:"16px",children:r("common:suggestion").toUpperCase()}),l(R,{spacing:"16px",children:V==null?void 0:V.map(y=>l(wi,{info:{avatar:y.avatar,id:y.id,name:y.name,checked:y.checked},opacity:$.length>0&&!$.some(m=>m.id===y.id)?".4":1,onSelected:Z},y.id))})]}),!(V!=null&&V.length)&&!b&&l(q,{textAlign:"center",fontWeight:"bold",my:"auto",fontSize:20,children:r("common:no_data")})]}),l(R,{direction:"row",mt:"4",justify:"flex-end",align:"center",spacing:"6",px:4,children:l(An,{currentPage:(d=T==null?void 0:T.current_page)!=null?d:1,perPage:Number(T==null?void 0:T.per_page),totalCount:(S=T==null?void 0:T.total)!=null?S:1,onPageChange:y=>P({page:y})})})]})}].filter(Boolean)})})});function Ho(){return lt(Pe({url:Y.LIST_DEVICES,method:"get"}))}function Wo({configs:n}={}){const e=Le(),{data:t,...i}=ct({...n,queryFn:Ho,queryKey:[Y.LIST]}),r=I.exports.useMemo(()=>{var c;return(c=t==null?void 0:t.devices)!=null?c:[]},[t==null?void 0:t.devices]);function s(){e.refetchQueries([Y.LIST_DEVICES])}return{devicesList:r,invalidateQueryDevicesList:s,...i}}const Wn=mt.memo(()=>{const{t:n}=Je(["common","patients"]),e=ss(),{formState:t,register:i,control:r}=e,{errors:s,defaultValues:c,isSubmitting:p}=t,f=e.getValues("avatar")instanceof File?"":String(e.getValues("avatar")),{devicesList:v,isLoading:_}=Wo();return E(R,{pt:"8px",children:[l(no,{initUrl:f,control:r,name:"avatar",error:s==null?void 0:s.avatar,trigger:()=>l(re,{w:"169px",color:"secondary",fontWeight:700,size:"lg",variant:"ghost",leftIcon:l(br,{}),isDisabled:p,children:n("common:upload_photo")}),children:b=>l($e,{boxSize:"100px",src:b})}),E(Tr,{templateColumns:"repeat(2, 1fr)",gap:4,children:[l(J,{colSpan:{base:2,md:1},children:l(me,{label:n("common:info.first_name"),isRequired:!0,placeholder:n("common:info.form.enter_first_name"),registration:i("first_name"),error:s.first_name})}),l(J,{colSpan:{base:2,md:1},children:l(me,{label:n("common:info.middle_name"),isRequired:!0,placeholder:n("common:info.form.enter_middle_name"),registration:i("middle_name"),error:s.middle_name})}),l(J,{colSpan:{base:2,md:1},children:l(me,{label:n("common:info.last_name"),isRequired:!0,placeholder:n("common:info.form.enter_last_name"),registration:i("last_name"),error:s.last_name})}),l(J,{colSpan:{base:2,md:1},children:l(kt,{options:Er,label:n("common:info.gender"),placeholder:c!=null&&c.gender?void 0:n("common:please_select"),isRequired:!0,registration:i("gender",{valueAsNumber:!0}),error:s.gender})}),l(J,{colSpan:{base:2,md:1},children:l(kt,{options:[{label:"RPM",value:Ge.RPM},{label:"Customer",value:Ge.Customer}],label:n("common:table.group"),placeholder:c!=null&&c.type?void 0:n("common:please_select"),isRequired:!0,registration:i("type",{valueAsNumber:!0}),error:s.type})}),l(J,{colSpan:{base:2,md:1},children:l(me,{label:n("common:info.date_of_birth"),isRequired:!0,placeholder:n("common:info.form.enter_date"),type:"date",registration:i("birthday"),error:s.birthday})}),l(J,{colSpan:2,children:l(me,{label:n("common:info.email"),placeholder:n("common:info.form.enter_email"),registration:i("email"),error:s.email})}),l(J,{colSpan:{base:2,md:1},children:l(St,{name:"phone",control:r,render:({field:{value:b,onChange:k,...T}})=>l(me,{label:"Phone number",placeholder:"012-345-6789",isRequired:!0,error:s==null?void 0:s.phone,value:b!=null?b:"",maxLength:12,onChange:P=>{k(on(P.target.value))},...T})})}),l(J,{colSpan:{base:2,md:1},children:l(kt,{options:v==null?void 0:v.map(b=>({label:b.name,value:b.id})),label:"Device",placeholder:c!=null&&c.device_id?void 0:"Please select",isRequired:!0,isDisabled:_,registration:i("device_id",{valueAsNumber:!0}),error:s.device_id})}),l(J,{colSpan:1,children:l(St,{name:"weight",control:r,defaultValue:void 0,render:({field:{...b}})=>l(gi,{label:"Weight (lbs)",min:1,max:999,precision:2,step:.02,numberInputFieldProps:{name:b.name},allowMouseWheel:!0,error:s==null?void 0:s.weight,...b,onChange:k=>k?b.onChange(Number(k)):void 0})})}),l(J,{colSpan:1,children:l(St,{name:"height",control:r,defaultValue:void 0,render:({field:{...b}})=>l(gi,{label:"Height (in)",allowMouseWheel:!0,min:1,max:999,precision:2,step:.02,numberInputFieldProps:{name:b.name},...b,error:s==null?void 0:s.height,onChange:k=>k?b.onChange(Number(k)):void 0})})}),l(J,{colSpan:2,children:l(at,{variant:"title",children:"Address"})}),l(J,{colSpan:2,children:l(me,{label:n("common:info.street_address"),isRequired:!0,placeholder:n("common:info.form.enter_street_address"),registration:i("street"),error:s==null?void 0:s.street})}),l(J,{colSpan:{base:2,lg:1},children:l(me,{label:n("common:info.city"),placeholder:n("common:info.form.enter_city"),isRequired:!0,registration:i("city"),error:s==null?void 0:s.city})}),l(J,{colSpan:{base:2,lg:1},children:l(me,{label:n("common:info.state"),placeholder:n("common:info.form.enter_state"),isRequired:!0,registration:i("state"),error:s==null?void 0:s.state})}),l(J,{colSpan:{base:2,lg:1},children:l(me,{type:"number",label:n("common:info.zip_code"),placeholder:n("common:info.form.enter_zip_code"),isRequired:!0,registration:i("zip_code"),error:s==null?void 0:s.zip_code,minLength:4,maxLength:10})}),l(J,{colSpan:{base:2,lg:1},children:l(me,{label:n("common:info.country"),placeholder:n("common:info.form.enter_country"),isRequired:!0,registration:i("country"),error:s==null?void 0:s.country})}),l(J,{colSpan:2,children:l(at,{variant:"title",children:n("common:info.emergency_contact")})}),l(J,{colSpan:{base:2,lg:1},children:l(me,{label:n("common:info.form.emergency_name"),placeholder:n("common:info.form.enter_emergency_name"),isRequired:!0,registration:i("emergency_name"),error:s==null?void 0:s.emergency_name})}),l(J,{colSpan:{base:2,lg:1},children:l(St,{name:"emergency_cellphone",control:r,render:({field:{value:b,onChange:k,...T}})=>l(me,{label:n("common:info.form.emergency_cellphone"),placeholder:n("common:info.form.enter_emergency_cellphone"),isRequired:!0,error:s==null?void 0:s.emergency_cellphone,value:b!=null?b:"",maxLength:12,onChange:P=>{k(on(P.target.value))},...T})})}),l(J,{colSpan:2,children:l(me,{label:n("common:info.form.emergency_email"),placeholder:n("common:info.form.enter_emergency_email"),isRequired:!0,registration:i("emergency_email"),error:s==null?void 0:s.emergency_email})})]})]})});function Vo({isLoading:n=!1,queryParams:e,onQueryChange:t,resetQuery:i}){var ne,W,V,G,$,Z,j;const r=Lt({schema:hs}),{t:s}=Je(["common","patients"]),c=Po();function p(z){const K=Pt({...z,birthday:ye({date:z.birthday,format:"YYYY-MM-DD"})});c.mutate(K,{onSuccess(){T(),r.reset(),i()}})}const[f,v]=I.exports.useState([]),_=I.exports.useCallback(z=>v(()=>z),[v]),{step:b,resetStep:k,next:T,isLastStep:P}=so([l(Wn,{},"PatientsForm"),l(ds,{patientId:(G=(V=(W=(ne=c.data)==null?void 0:ne.data)==null?void 0:W.patient)==null?void 0:V.id)!=null?G:0,patientType:Number((j=(Z=($=c.data)==null?void 0:$.data)==null?void 0:Z.patient)==null?void 0:j.type),onAssignIds:_},"DoctorOrARNPToPatientCard")]),w=ls();function H(){var z,K,d,S,y,m,M;if(f.length>0&&((d=(K=(z=c.data)==null?void 0:z.data)==null?void 0:K.patient)==null?void 0:d.id)){const F={patient_id:(M=(m=(y=(S=c.data)==null?void 0:S.data)==null?void 0:y.patient)==null?void 0:m.id)!=null?M:0};f.forEach((N,We,_e)=>{N.role===U.Doctor&&(F.doctor_id=N.id),N.role===U.ARNP&&(F.arnp_id=N.id),N.role===U.Doctor&&_e.every(Ce=>Ce.role===U.Doctor)&&(F.doctor_id=N.id,F.arnp_id=0),N.role===U.ARNP&&_e.every(Ce=>Ce.role===U.ARNP)&&(F.arnp_id=N.id,F.doctor_id=0)}),w.mutate(F)}}return E(R,{p:4,spacing:{base:4,lg:10},bg:"white",direction:{base:"column",lg:"row"},justify:"space-between",align:"center",children:[l(R,{w:{base:"full"},spacing:2,children:E(R,{align:"center",direction:{base:"column",lg:"row"},spacing:"16px",w:"full",children:[l(Ie,{allowedRoles:yi.concat(vi),children:E(R,{w:"full",direction:{base:"column",md:"row"},spacing:3,children:[l(Ie,{allowedRoles:yi,children:l(kt,{isDisabled:n,options:[{label:"All group",value:0}].concat(Sr),value:e.type,onChange:z=>Number(z.target.value)===0?t({type:void 0}):t({page:1,type:Number(z.target.value)})})}),l(Ie,{allowedRoles:vi,children:l(kt,{isDisabled:n,options:[{label:s("patients:form.assign_doctor/arnp"),value:-1},{label:s("patients:form.assigned"),value:_i.Assigned},{label:s("patients:form.unassigned"),value:_i.Unassigned}],value:e.assign,onChange:z=>Number(z.target.value)===-1?t({assign:void 0}):t({page:1,assign:Number(z.target.value)})})})]})}),l(Ie,{allowedRoles:xr,children:l(He,{w:"full",children:l(kn,{w:"full",isDisabled:n,onHandleSearch:z=>{t({page:1,keyword:z})}})})})]})}),l(Ie,{allowedRoles:kr,children:l(Mt,{form:r,id:"add patients",onSubmit:p,children:l(co,{isDone:w.isSuccess,size:"2xl",title:s(P?"patients:form.assign_doctor_to_patient":"patients:form.add_new_patient"),triggerBtn:()=>l(re,{bg:"primary",color:"white",leftIcon:l(Cr,{}),mt:{base:2,md:0},size:{base:"lg",md:"lg"},isDisabled:c.isLoading||n,children:l(He,{as:"span",fontSize:"16px",children:s("patients:form.add_new_patient")})}),renderFooter:()=>P?l(re,{w:"348px",size:"lg",type:"button",isLoading:w.isLoading,isDisabled:!f.length||w.isLoading,onClick:H,children:s("common:submit")}):l(re,{w:"348px",size:"lg",type:"submit",form:"add patients",isLoading:c.isLoading,isDisabled:c.isLoading,children:s("common:save")}),onBeforeTrigger:()=>{k(),r.reset(),r.clearErrors(),w.reset(),c.reset()},children:b})})})]})}function Xo({patientInfo:n,...e}){const{formState:t,control:i}=ss(),{errors:r}=t;return E(R,{spacing:"18px",...e,children:[E(R,{rounded:8,direction:"row",align:"center",children:[l($e,{src:n==null?void 0:n.avatar,boxSize:10}),E(en,{direction:"column",justify:"space-between",children:[l(q,{children:n.name}),l(q,{color:"primary",fontWeight:600,children:Ge[n==null?void 0:n.type]})]})]}),l(St,{name:"content",control:i,render:({field:{value:s,onChange:c}})=>{var p;return E(Se,{children:[l(lo,{defaultValue:s,onChange:c}),l(q,{color:"red.600",children:(p=r.content)==null?void 0:p.message})]})}})]})}const ps=mt.memo(Xo);function gl(){const{checkAccess:n}=Un(),{t:e}=Je(["common","patients"]),{queryParams:t,patientsList:i,patientsPaging:r,setQuery:s,invalidateQueryPatientList:c,resetQuery:p,...f}=Ro(),v=ns(),_=Le(),b=es(),k=Nt(),T=Rt(),P=Rt(),w=Nt(),H=Lt({schema:fs}),{isDirtyField:ne,reset:W,getFieldState:V,getValues:G}=H,$=Lt({schema:Hn}),Z=us();function j(d,S){v.mutate(Pt({...d,id:S.user_id,birthday:ye({date:C(d.birthday),format:"YYYY-MM-DD"})}),{onSuccess(){var y;_.refetchQueries([Y.LIST]),_.refetchQueries([Y.DETAIL,S.id],{type:"all"}),_.refetchQueries([an.DETAIL,(y=S==null?void 0:S.doctor)==null?void 0:y.user_id],{type:"all"})}})}function z(d){b.mutate(d.user_id,{onSuccess:async()=>{var S;_.refetchQueries([an.DETAIL,(S=d==null?void 0:d.doctor)==null?void 0:S.user_id],{type:"all"}),_.removeQueries([Y.DETAIL,d.id],{type:"all"}),c()}})}const K=I.exports.useMemo(()=>[{header:"User",columns:[{key:"special_id",title:"ID",Cell({special_id:d}){return l(q,{textAlign:"left",children:d})}},{key:"avatar",title:e("common:table.patient").toUpperCase(),Cell:({id:d,avatar:S,phone:y,...m})=>l(Ct,{to:String(d),textProps:{noOfLines:2},children:E(R,{direction:"row",children:[l($e,{src:S,boxSize:"40px",rounded:"full"}),E(en,{direction:"column",children:[l(q,{children:Ee({firstName:m==null?void 0:m.first_name,middleName:m==null?void 0:m.middle_name,lastName:m==null?void 0:m.last_name})}),l(q,{color:"primary",children:y})]})]})})},{key:"doctor",title:e("patients:form.assign_doctor/arnp").toUpperCase(),Cell({doctor:d,arnp:S}){return E(Se,{children:[E(R,{spacing:2,direction:"column",children:[d&&l(Ct,{_hover:n({allowedRoles:[U.Admin]})?{textDecor:"underline"}:{textDecor:"none",cursor:"default"},to:n({allowedRoles:[U.Admin]})?`${ft.CLINIC_TEAM}/${d==null?void 0:d.user_id}`:"",children:E(R,{direction:"row",spacing:3,children:[l($e,{src:d==null?void 0:d.avatar,boxSize:"30px",rounded:"full"}),E(en,{direction:"column",children:[l(q,{noOfLines:2,children:Ee({firstName:d==null?void 0:d.first_name,middleName:d==null?void 0:d.middle_name,lastName:d==null?void 0:d.last_name})}),l(q,{color:"primary",children:e("patients:form.doctor")})]})]})}),S&&l(Ct,{_hover:n({allowedRoles:[U.Admin]})?{textDecor:"underline"}:{textDecor:"none",cursor:"default"},to:n({allowedRoles:[U.Admin]})?`${ft.CLINIC_TEAM}/${S==null?void 0:S.user_id}`:"",children:E(R,{direction:"row",spacing:3,children:[l($e,{src:S==null?void 0:S.avatar,boxSize:"30px",rounded:"full"}),E(en,{direction:"column",children:[l(q,{noOfLines:2,children:Ee({firstName:S==null?void 0:S.first_name,middleName:S==null?void 0:S.middle_name,lastName:S==null?void 0:S.last_name})}),l(q,{color:"primary",children:e("patients:form.arnp")})]})]})})]}),!d&&!S&&l(q,{fontWeight:"bold",children:e("patients:form.unassigned")})]})}},{key:"gender",title:e("common:info.gender").toUpperCase()},{key:"birthday",title:e("common:info.d_o_b").toUpperCase()},{key:"type",title:"Group",Cell({type:d}){return l(q,{color:"primary",textAlign:"left",children:Ge[d]})}},{key:"city",title:e("common:info.address").toUpperCase(),Cell({state:d,city:S,street:y,country:m,zip_code:M}){return l(q,{fontWeight:700,children:Vi({city:S,state:d,street:y,country:m,zipCode:M})})}},{key:"zip_code",title:e("common:table.status").toUpperCase(),Cell({user_id:d,status:S}){return n({allowedRoles:Cn})?l(uo,{userId:d,initActive:S?!!wr[S]:void 0,onSuccess:()=>{c()}}):l(Ar,{colorScheme:S?"green":"red",rounded:4,children:e(S?"common:table.active":"common:table.inactive")})}}]}],[n,c,e]);return E(Se,{children:[l(os,{title:e("patients:list.patient_management")}),E(R,{children:[l(Vo,{isLoading:f.isLoading,queryParams:t,resetQuery:p,onQueryChange:d=>{s({...d})}}),l(Kr,{currentPage:r==null?void 0:r.current_page,perPage:Number(r==null?void 0:r.per_page),data:i!=null?i:[],groupColumns:K,totalCount:r==null?void 0:r.total,isLoading:f.isLoading,error:f.isError,maxWidthColumn:185,additionalFeature:n({allowedRoles:Pr})?({...d})=>l(ho,{menuItems:[n({allowedRoles:Cn})&&{label:e("patients:list.edit_patient_info"),icon:l(ro,{}),onClick:()=>{var S,y;W(Pt({...d,gender:Xi[d.gender],birthday:ye({date:d.birthday,format:"YYYY-MM-DD"}),emergency_cellphone:on(d.emergency_cellphone),device_id:(S=d==null?void 0:d.device)==null?void 0:S.id})),(y=T.current)==null||y.openModal()}},n({allowedRoles:ji})&&{label:e("common:socket_group.make_note"),icon:l(oo,{}),onClick(){var S;Z.reset(),(S=P.current)==null||S.openModal()}},n({allowedRoles:Qi})&&{label:e("patients:list.delete_patient"),icon:l(rs,{}),onClick:()=>{var S;(S=k.current)==null||S.show()}}].filter(Boolean),children:S=>E(Se,{children:[l(ao,{isOpen:S}),l(Ot,{ref:P,title:e("patients:list.make_note_for_patient"),isDone:Z.isSuccess,renderFooter:()=>l(re,{size:"lg",w:"384px",form:"note-form",type:"submit",isLoading:Z.isLoading,isDisabled:Z.isLoading||!$.isDirtyField,children:e("common:socket_group.make_note")}),children:l(Mt,{form:$,id:"note-form",onSubmit:y=>Z.mutate({patient_id:d.id,content:y.content},{onSuccess(){$.reset(),$.clearErrors()}}),children:l(ps,{patientInfo:{avatar:d.avatar,name:Ee({firstName:d==null?void 0:d.first_name,middleName:d==null?void 0:d.middle_name,lastName:d==null?void 0:d.last_name}),type:d.type}})})}),l(It,{ref:k,isLoading:b.isLoading,isDone:b.isSuccess,onHandleConfirm:()=>z(d)}),l(Ot,{ref:T,isDone:v.isSuccess,title:"Update Patient",renderFooter:()=>{var y;return l(re,{w:"348px",size:"lg",type:"submit",form:"update-patient",isLoading:v.isLoading,isDisabled:!ne||v.isLoading&&!((y=w.current)!=null&&y.isOpen),children:e("common:save")})},onBeforeClose:()=>{H.reset(),H.clearErrors(),v.reset()},children:E(Mt,{form:H,id:"update-patient",onSubmit:y=>{var m;if(V("phone").isDirty||V("type").isDirty){(m=w.current)==null||m.show();return}j(y,d)},children:[l(Wn,{}),l(It,{ref:w,isDone:v.isSuccess,isLoading:v.isLoading,title:e("patients:form.update_confirm"),description:e("patients:form.are_you_sure_you_want_to_change_profile"),type:"info",textConfirm:"Save",onHandleConfirm:()=>{const y=G();j(y,d)}})]})})]})}):void 0,onPageChange:(d,S)=>s({page:d,per_page:S})})]})]})}var ms={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(Nr,function(){return function(t,i){i.prototype.weekday=function(r){var s=this.$locale().weekStart||0,c=this.$W,p=(c<s?c+7:c)-s;return this.$utils().u(r)?p:this.subtract(p,"day").add(r,"day")}}})})(ms);const jo=ms.exports;var gs={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(n){(function(e,t,i,r){var s=["","webkit","Moz","MS","ms","o"],c=t.createElement("div"),p="function",f=Math.round,v=Math.abs,_=Date.now;function b(o,a,u){return setTimeout(V(o,u),a)}function k(o,a,u){return Array.isArray(o)?(T(o,u[a],u),!0):!1}function T(o,a,u){var h;if(!!o)if(o.forEach)o.forEach(a,u);else if(o.length!==r)for(h=0;h<o.length;)a.call(u,o[h],h,o),h++;else for(h in o)o.hasOwnProperty(h)&&a.call(u,o[h],h,o)}function P(o,a,u){var h="DEPRECATED METHOD: "+a+`
`+u+` AT 
`;return function(){var g=new Error("get-stack-trace"),x=g&&g.stack?g.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",D=e.console&&(e.console.warn||e.console.log);return D&&D.call(e.console,h,x),o.apply(this,arguments)}}var w;typeof Object.assign!="function"?w=function(a){if(a===r||a===null)throw new TypeError("Cannot convert undefined or null to object");for(var u=Object(a),h=1;h<arguments.length;h++){var g=arguments[h];if(g!==r&&g!==null)for(var x in g)g.hasOwnProperty(x)&&(u[x]=g[x])}return u}:w=Object.assign;var H=P(function(a,u,h){for(var g=Object.keys(u),x=0;x<g.length;)(!h||h&&a[g[x]]===r)&&(a[g[x]]=u[g[x]]),x++;return a},"extend","Use `assign`."),ne=P(function(a,u){return H(a,u,!0)},"merge","Use `assign`.");function W(o,a,u){var h=a.prototype,g;g=o.prototype=Object.create(h),g.constructor=o,g._super=h,u&&w(g,u)}function V(o,a){return function(){return o.apply(a,arguments)}}function G(o,a){return typeof o==p?o.apply(a&&a[0]||r,a):o}function $(o,a){return o===r?a:o}function Z(o,a,u){T(d(a),function(h){o.addEventListener(h,u,!1)})}function j(o,a,u){T(d(a),function(h){o.removeEventListener(h,u,!1)})}function z(o,a){for(;o;){if(o==a)return!0;o=o.parentNode}return!1}function K(o,a){return o.indexOf(a)>-1}function d(o){return o.trim().split(/\s+/g)}function S(o,a,u){if(o.indexOf&&!u)return o.indexOf(a);for(var h=0;h<o.length;){if(u&&o[h][u]==a||!u&&o[h]===a)return h;h++}return-1}function y(o){return Array.prototype.slice.call(o,0)}function m(o,a,u){for(var h=[],g=[],x=0;x<o.length;){var D=a?o[x][a]:o[x];S(g,D)<0&&h.push(o[x]),g[x]=D,x++}return u&&(a?h=h.sort(function(ce,fe){return ce[a]>fe[a]}):h=h.sort()),h}function M(o,a){for(var u,h,g=a[0].toUpperCase()+a.slice(1),x=0;x<s.length;){if(u=s[x],h=u?u+g:a,h in o)return h;x++}return r}var F=1;function N(){return F++}function We(o){var a=o.ownerDocument||o;return a.defaultView||a.parentWindow||e}var _e=/mobile|tablet|ip(ad|hone|od)|android/i,Ce="ontouchstart"in e,tt=M(e,"PointerEvent")!==r,nt=Ce&&_e.test(navigator.userAgent),Ne="touch",it="pen",A="mouse",O="kinect",Me=25,X=1,be=2,Q=4,L=8,Te=1,he=2,de=4,ut=8,Ve=16,pe=he|de,st=ut|Ve,Gn=pe|st,Zn=["x","y"],Yt=["clientX","clientY"];function we(o,a){var u=this;this.manager=o,this.callback=a,this.element=o.element,this.target=o.options.inputTarget,this.domHandler=function(h){G(o.options.enable,[o])&&u.handler(h)},this.init()}we.prototype={handler:function(){},init:function(){this.evEl&&Z(this.element,this.evEl,this.domHandler),this.evTarget&&Z(this.target,this.evTarget,this.domHandler),this.evWin&&Z(We(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&j(this.element,this.evEl,this.domHandler),this.evTarget&&j(this.target,this.evTarget,this.domHandler),this.evWin&&j(We(this.element),this.evWin,this.domHandler)}};function js(o){var a,u=o.options.inputClass;return u?a=u:tt?a=mn:nt?a=Wt:Ce?a=gn:a=Ht,new a(o,Qs)}function Qs(o,a,u){var h=u.pointers.length,g=u.changedPointers.length,x=a&X&&h-g===0,D=a&(Q|L)&&h-g===0;u.isFirst=!!x,u.isFinal=!!D,x&&(o.session={}),u.eventType=a,Ks(o,u),o.emit("hammer.input",u),o.recognize(u),o.session.prevInput=u}function Ks(o,a){var u=o.session,h=a.pointers,g=h.length;u.firstInput||(u.firstInput=Jn(a)),g>1&&!u.firstMultiple?u.firstMultiple=Jn(a):g===1&&(u.firstMultiple=!1);var x=u.firstInput,D=u.firstMultiple,oe=D?D.center:x.center,ce=a.center=ei(h);a.timeStamp=_(),a.deltaTime=a.timeStamp-x.timeStamp,a.angle=pn(oe,ce),a.distance=Ut(oe,ce),$s(u,a),a.offsetDirection=ni(a.deltaX,a.deltaY);var fe=ti(a.deltaTime,a.deltaX,a.deltaY);a.overallVelocityX=fe.x,a.overallVelocityY=fe.y,a.overallVelocity=v(fe.x)>v(fe.y)?fe.x:fe.y,a.scale=D?Js(D.pointers,h):1,a.rotation=D?Zs(D.pointers,h):0,a.maxPointers=u.prevInput?a.pointers.length>u.prevInput.maxPointers?a.pointers.length:u.prevInput.maxPointers:a.pointers.length,Gs(u,a);var Be=o.element;z(a.srcEvent.target,Be)&&(Be=a.srcEvent.target),a.target=Be}function $s(o,a){var u=a.center,h=o.offsetDelta||{},g=o.prevDelta||{},x=o.prevInput||{};(a.eventType===X||x.eventType===Q)&&(g=o.prevDelta={x:x.deltaX||0,y:x.deltaY||0},h=o.offsetDelta={x:u.x,y:u.y}),a.deltaX=g.x+(u.x-h.x),a.deltaY=g.y+(u.y-h.y)}function Gs(o,a){var u=o.lastInterval||a,h=a.timeStamp-u.timeStamp,g,x,D,oe;if(a.eventType!=L&&(h>Me||u.velocity===r)){var ce=a.deltaX-u.deltaX,fe=a.deltaY-u.deltaY,Be=ti(h,ce,fe);x=Be.x,D=Be.y,g=v(Be.x)>v(Be.y)?Be.x:Be.y,oe=ni(ce,fe),o.lastInterval=a}else g=u.velocity,x=u.velocityX,D=u.velocityY,oe=u.direction;a.velocity=g,a.velocityX=x,a.velocityY=D,a.direction=oe}function Jn(o){for(var a=[],u=0;u<o.pointers.length;)a[u]={clientX:f(o.pointers[u].clientX),clientY:f(o.pointers[u].clientY)},u++;return{timeStamp:_(),pointers:a,center:ei(a),deltaX:o.deltaX,deltaY:o.deltaY}}function ei(o){var a=o.length;if(a===1)return{x:f(o[0].clientX),y:f(o[0].clientY)};for(var u=0,h=0,g=0;g<a;)u+=o[g].clientX,h+=o[g].clientY,g++;return{x:f(u/a),y:f(h/a)}}function ti(o,a,u){return{x:a/o||0,y:u/o||0}}function ni(o,a){return o===a?Te:v(o)>=v(a)?o<0?he:de:a<0?ut:Ve}function Ut(o,a,u){u||(u=Zn);var h=a[u[0]]-o[u[0]],g=a[u[1]]-o[u[1]];return Math.sqrt(h*h+g*g)}function pn(o,a,u){u||(u=Zn);var h=a[u[0]]-o[u[0]],g=a[u[1]]-o[u[1]];return Math.atan2(g,h)*180/Math.PI}function Zs(o,a){return pn(a[1],a[0],Yt)+pn(o[1],o[0],Yt)}function Js(o,a){return Ut(a[0],a[1],Yt)/Ut(o[0],o[1],Yt)}var er={mousedown:X,mousemove:be,mouseup:Q},tr="mousedown",nr="mousemove mouseup";function Ht(){this.evEl=tr,this.evWin=nr,this.pressed=!1,we.apply(this,arguments)}W(Ht,we,{handler:function(a){var u=er[a.type];u&X&&a.button===0&&(this.pressed=!0),u&be&&a.which!==1&&(u=Q),this.pressed&&(u&Q&&(this.pressed=!1),this.callback(this.manager,u,{pointers:[a],changedPointers:[a],pointerType:A,srcEvent:a}))}});var ir={pointerdown:X,pointermove:be,pointerup:Q,pointercancel:L,pointerout:L},sr={2:Ne,3:it,4:A,5:O},ii="pointerdown",si="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(ii="MSPointerDown",si="MSPointerMove MSPointerUp MSPointerCancel");function mn(){this.evEl=ii,this.evWin=si,we.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}W(mn,we,{handler:function(a){var u=this.store,h=!1,g=a.type.toLowerCase().replace("ms",""),x=ir[g],D=sr[a.pointerType]||a.pointerType,oe=D==Ne,ce=S(u,a.pointerId,"pointerId");x&X&&(a.button===0||oe)?ce<0&&(u.push(a),ce=u.length-1):x&(Q|L)&&(h=!0),!(ce<0)&&(u[ce]=a,this.callback(this.manager,x,{pointers:u,changedPointers:[a],pointerType:D,srcEvent:a}),h&&u.splice(ce,1))}});var rr={touchstart:X,touchmove:be,touchend:Q,touchcancel:L},or="touchstart",ar="touchstart touchmove touchend touchcancel";function ri(){this.evTarget=or,this.evWin=ar,this.started=!1,we.apply(this,arguments)}W(ri,we,{handler:function(a){var u=rr[a.type];if(u===X&&(this.started=!0),!!this.started){var h=cr.call(this,a,u);u&(Q|L)&&h[0].length-h[1].length===0&&(this.started=!1),this.callback(this.manager,u,{pointers:h[0],changedPointers:h[1],pointerType:Ne,srcEvent:a})}}});function cr(o,a){var u=y(o.touches),h=y(o.changedTouches);return a&(Q|L)&&(u=m(u.concat(h),"identifier",!0)),[u,h]}var lr={touchstart:X,touchmove:be,touchend:Q,touchcancel:L},ur="touchstart touchmove touchend touchcancel";function Wt(){this.evTarget=ur,this.targetIds={},we.apply(this,arguments)}W(Wt,we,{handler:function(a){var u=lr[a.type],h=hr.call(this,a,u);!h||this.callback(this.manager,u,{pointers:h[0],changedPointers:h[1],pointerType:Ne,srcEvent:a})}});function hr(o,a){var u=y(o.touches),h=this.targetIds;if(a&(X|be)&&u.length===1)return h[u[0].identifier]=!0,[u,u];var g,x,D=y(o.changedTouches),oe=[],ce=this.target;if(x=u.filter(function(fe){return z(fe.target,ce)}),a===X)for(g=0;g<x.length;)h[x[g].identifier]=!0,g++;for(g=0;g<D.length;)h[D[g].identifier]&&oe.push(D[g]),a&(Q|L)&&delete h[D[g].identifier],g++;if(!!oe.length)return[m(x.concat(oe),"identifier",!0),oe]}var fr=2500,oi=25;function gn(){we.apply(this,arguments);var o=V(this.handler,this);this.touch=new Wt(this.manager,o),this.mouse=new Ht(this.manager,o),this.primaryTouch=null,this.lastTouches=[]}W(gn,we,{handler:function(a,u,h){var g=h.pointerType==Ne,x=h.pointerType==A;if(!(x&&h.sourceCapabilities&&h.sourceCapabilities.firesTouchEvents)){if(g)dr.call(this,u,h);else if(x&&pr.call(this,h))return;this.callback(a,u,h)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function dr(o,a){o&X?(this.primaryTouch=a.changedPointers[0].identifier,ai.call(this,a)):o&(Q|L)&&ai.call(this,a)}function ai(o){var a=o.changedPointers[0];if(a.identifier===this.primaryTouch){var u={x:a.clientX,y:a.clientY};this.lastTouches.push(u);var h=this.lastTouches,g=function(){var x=h.indexOf(u);x>-1&&h.splice(x,1)};setTimeout(g,fr)}}function pr(o){for(var a=o.srcEvent.clientX,u=o.srcEvent.clientY,h=0;h<this.lastTouches.length;h++){var g=this.lastTouches[h],x=Math.abs(a-g.x),D=Math.abs(u-g.y);if(x<=oi&&D<=oi)return!0}return!1}var ci=M(c.style,"touchAction"),li=ci!==r,ui="compute",hi="auto",yn="manipulation",rt="none",vt="pan-x",_t="pan-y",Vt=gr();function vn(o,a){this.manager=o,this.set(a)}vn.prototype={set:function(o){o==ui&&(o=this.compute()),li&&this.manager.element.style&&Vt[o]&&(this.manager.element.style[ci]=o),this.actions=o.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var o=[];return T(this.manager.recognizers,function(a){G(a.options.enable,[a])&&(o=o.concat(a.getTouchAction()))}),mr(o.join(" "))},preventDefaults:function(o){var a=o.srcEvent,u=o.offsetDirection;if(this.manager.session.prevented){a.preventDefault();return}var h=this.actions,g=K(h,rt)&&!Vt[rt],x=K(h,_t)&&!Vt[_t],D=K(h,vt)&&!Vt[vt];if(g){var oe=o.pointers.length===1,ce=o.distance<2,fe=o.deltaTime<250;if(oe&&ce&&fe)return}if(!(D&&x)&&(g||x&&u&pe||D&&u&st))return this.preventSrc(a)},preventSrc:function(o){this.manager.session.prevented=!0,o.preventDefault()}};function mr(o){if(K(o,rt))return rt;var a=K(o,vt),u=K(o,_t);return a&&u?rt:a||u?a?vt:_t:K(o,yn)?yn:hi}function gr(){if(!li)return!1;var o={},a=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(u){o[u]=a?e.CSS.supports("touch-action",u):!0}),o}var Xt=1,Ae=2,ht=4,Xe=8,ze=Xe,bt=16,De=32;function Ye(o){this.options=w({},this.defaults,o||{}),this.id=N(),this.manager=null,this.options.enable=$(this.options.enable,!0),this.state=Xt,this.simultaneous={},this.requireFail=[]}Ye.prototype={defaults:{},set:function(o){return w(this.options,o),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(o){if(k(o,"recognizeWith",this))return this;var a=this.simultaneous;return o=jt(o,this),a[o.id]||(a[o.id]=o,o.recognizeWith(this)),this},dropRecognizeWith:function(o){return k(o,"dropRecognizeWith",this)?this:(o=jt(o,this),delete this.simultaneous[o.id],this)},requireFailure:function(o){if(k(o,"requireFailure",this))return this;var a=this.requireFail;return o=jt(o,this),S(a,o)===-1&&(a.push(o),o.requireFailure(this)),this},dropRequireFailure:function(o){if(k(o,"dropRequireFailure",this))return this;o=jt(o,this);var a=S(this.requireFail,o);return a>-1&&this.requireFail.splice(a,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(o){return!!this.simultaneous[o.id]},emit:function(o){var a=this,u=this.state;function h(g){a.manager.emit(g,o)}u<Xe&&h(a.options.event+fi(u)),h(a.options.event),o.additionalEvent&&h(o.additionalEvent),u>=Xe&&h(a.options.event+fi(u))},tryEmit:function(o){if(this.canEmit())return this.emit(o);this.state=De},canEmit:function(){for(var o=0;o<this.requireFail.length;){if(!(this.requireFail[o].state&(De|Xt)))return!1;o++}return!0},recognize:function(o){var a=w({},o);if(!G(this.options.enable,[this,a])){this.reset(),this.state=De;return}this.state&(ze|bt|De)&&(this.state=Xt),this.state=this.process(a),this.state&(Ae|ht|Xe|bt)&&this.tryEmit(a)},process:function(o){},getTouchAction:function(){},reset:function(){}};function fi(o){return o&bt?"cancel":o&Xe?"end":o&ht?"move":o&Ae?"start":""}function di(o){return o==Ve?"down":o==ut?"up":o==he?"left":o==de?"right":""}function jt(o,a){var u=a.manager;return u?u.get(o):o}function Re(){Ye.apply(this,arguments)}W(Re,Ye,{defaults:{pointers:1},attrTest:function(o){var a=this.options.pointers;return a===0||o.pointers.length===a},process:function(o){var a=this.state,u=o.eventType,h=a&(Ae|ht),g=this.attrTest(o);return h&&(u&L||!g)?a|bt:h||g?u&Q?a|Xe:a&Ae?a|ht:Ae:De}});function Qt(){Re.apply(this,arguments),this.pX=null,this.pY=null}W(Qt,Re,{defaults:{event:"pan",threshold:10,pointers:1,direction:Gn},getTouchAction:function(){var o=this.options.direction,a=[];return o&pe&&a.push(_t),o&st&&a.push(vt),a},directionTest:function(o){var a=this.options,u=!0,h=o.distance,g=o.direction,x=o.deltaX,D=o.deltaY;return g&a.direction||(a.direction&pe?(g=x===0?Te:x<0?he:de,u=x!=this.pX,h=Math.abs(o.deltaX)):(g=D===0?Te:D<0?ut:Ve,u=D!=this.pY,h=Math.abs(o.deltaY))),o.direction=g,u&&h>a.threshold&&g&a.direction},attrTest:function(o){return Re.prototype.attrTest.call(this,o)&&(this.state&Ae||!(this.state&Ae)&&this.directionTest(o))},emit:function(o){this.pX=o.deltaX,this.pY=o.deltaY;var a=di(o.direction);a&&(o.additionalEvent=this.options.event+a),this._super.emit.call(this,o)}});function _n(){Re.apply(this,arguments)}W(_n,Re,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[rt]},attrTest:function(o){return this._super.attrTest.call(this,o)&&(Math.abs(o.scale-1)>this.options.threshold||this.state&Ae)},emit:function(o){if(o.scale!==1){var a=o.scale<1?"in":"out";o.additionalEvent=this.options.event+a}this._super.emit.call(this,o)}});function bn(){Ye.apply(this,arguments),this._timer=null,this._input=null}W(bn,Ye,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[hi]},process:function(o){var a=this.options,u=o.pointers.length===a.pointers,h=o.distance<a.threshold,g=o.deltaTime>a.time;if(this._input=o,!h||!u||o.eventType&(Q|L)&&!g)this.reset();else if(o.eventType&X)this.reset(),this._timer=b(function(){this.state=ze,this.tryEmit()},a.time,this);else if(o.eventType&Q)return ze;return De},reset:function(){clearTimeout(this._timer)},emit:function(o){this.state===ze&&(o&&o.eventType&Q?this.manager.emit(this.options.event+"up",o):(this._input.timeStamp=_(),this.manager.emit(this.options.event,this._input)))}});function Tn(){Re.apply(this,arguments)}W(Tn,Re,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[rt]},attrTest:function(o){return this._super.attrTest.call(this,o)&&(Math.abs(o.rotation)>this.options.threshold||this.state&Ae)}});function En(){Re.apply(this,arguments)}W(En,Re,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:pe|st,pointers:1},getTouchAction:function(){return Qt.prototype.getTouchAction.call(this)},attrTest:function(o){var a=this.options.direction,u;return a&(pe|st)?u=o.overallVelocity:a&pe?u=o.overallVelocityX:a&st&&(u=o.overallVelocityY),this._super.attrTest.call(this,o)&&a&o.offsetDirection&&o.distance>this.options.threshold&&o.maxPointers==this.options.pointers&&v(u)>this.options.velocity&&o.eventType&Q},emit:function(o){var a=di(o.offsetDirection);a&&this.manager.emit(this.options.event+a,o),this.manager.emit(this.options.event,o)}});function Kt(){Ye.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}W(Kt,Ye,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[yn]},process:function(o){var a=this.options,u=o.pointers.length===a.pointers,h=o.distance<a.threshold,g=o.deltaTime<a.time;if(this.reset(),o.eventType&X&&this.count===0)return this.failTimeout();if(h&&g&&u){if(o.eventType!=Q)return this.failTimeout();var x=this.pTime?o.timeStamp-this.pTime<a.interval:!0,D=!this.pCenter||Ut(this.pCenter,o.center)<a.posThreshold;this.pTime=o.timeStamp,this.pCenter=o.center,!D||!x?this.count=1:this.count+=1,this._input=o;var oe=this.count%a.taps;if(oe===0)return this.hasRequireFailures()?(this._timer=b(function(){this.state=ze,this.tryEmit()},a.interval,this),Ae):ze}return De},failTimeout:function(){return this._timer=b(function(){this.state=De},this.options.interval,this),De},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ze&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ue(o,a){return a=a||{},a.recognizers=$(a.recognizers,Ue.defaults.preset),new Sn(o,a)}Ue.VERSION="2.0.7",Ue.defaults={domEvents:!1,touchAction:ui,enable:!0,inputTarget:null,inputClass:null,preset:[[Tn,{enable:!1}],[_n,{enable:!1},["rotate"]],[En,{direction:pe}],[Qt,{direction:pe},["swipe"]],[Kt],[Kt,{event:"doubletap",taps:2},["tap"]],[bn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var yr=1,pi=2;function Sn(o,a){this.options=w({},Ue.defaults,a||{}),this.options.inputTarget=this.options.inputTarget||o,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=o,this.input=js(this),this.touchAction=new vn(this,this.options.touchAction),mi(this,!0),T(this.options.recognizers,function(u){var h=this.add(new u[0](u[1]));u[2]&&h.recognizeWith(u[2]),u[3]&&h.requireFailure(u[3])},this)}Sn.prototype={set:function(o){return w(this.options,o),o.touchAction&&this.touchAction.update(),o.inputTarget&&(this.input.destroy(),this.input.target=o.inputTarget,this.input.init()),this},stop:function(o){this.session.stopped=o?pi:yr},recognize:function(o){var a=this.session;if(!a.stopped){this.touchAction.preventDefaults(o);var u,h=this.recognizers,g=a.curRecognizer;(!g||g&&g.state&ze)&&(g=a.curRecognizer=null);for(var x=0;x<h.length;)u=h[x],a.stopped!==pi&&(!g||u==g||u.canRecognizeWith(g))?u.recognize(o):u.reset(),!g&&u.state&(Ae|ht|Xe)&&(g=a.curRecognizer=u),x++}},get:function(o){if(o instanceof Ye)return o;for(var a=this.recognizers,u=0;u<a.length;u++)if(a[u].options.event==o)return a[u];return null},add:function(o){if(k(o,"add",this))return this;var a=this.get(o.options.event);return a&&this.remove(a),this.recognizers.push(o),o.manager=this,this.touchAction.update(),o},remove:function(o){if(k(o,"remove",this))return this;if(o=this.get(o),o){var a=this.recognizers,u=S(a,o);u!==-1&&(a.splice(u,1),this.touchAction.update())}return this},on:function(o,a){if(o!==r&&a!==r){var u=this.handlers;return T(d(o),function(h){u[h]=u[h]||[],u[h].push(a)}),this}},off:function(o,a){if(o!==r){var u=this.handlers;return T(d(o),function(h){a?u[h]&&u[h].splice(S(u[h],a),1):delete u[h]}),this}},emit:function(o,a){this.options.domEvents&&vr(o,a);var u=this.handlers[o]&&this.handlers[o].slice();if(!(!u||!u.length)){a.type=o,a.preventDefault=function(){a.srcEvent.preventDefault()};for(var h=0;h<u.length;)u[h](a),h++}},destroy:function(){this.element&&mi(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function mi(o,a){var u=o.element;if(!!u.style){var h;T(o.options.cssProps,function(g,x){h=M(u.style,x),a?(o.oldCssProps[h]=u.style[h],u.style[h]=g):u.style[h]=o.oldCssProps[h]||""}),a||(o.oldCssProps={})}}function vr(o,a){var u=t.createEvent("Event");u.initEvent(o,!0,!0),u.gesture=a,a.target.dispatchEvent(u)}w(Ue,{INPUT_START:X,INPUT_MOVE:be,INPUT_END:Q,INPUT_CANCEL:L,STATE_POSSIBLE:Xt,STATE_BEGAN:Ae,STATE_CHANGED:ht,STATE_ENDED:Xe,STATE_RECOGNIZED:ze,STATE_CANCELLED:bt,STATE_FAILED:De,DIRECTION_NONE:Te,DIRECTION_LEFT:he,DIRECTION_RIGHT:de,DIRECTION_UP:ut,DIRECTION_DOWN:Ve,DIRECTION_HORIZONTAL:pe,DIRECTION_VERTICAL:st,DIRECTION_ALL:Gn,Manager:Sn,Input:we,TouchAction:vn,TouchInput:Wt,MouseInput:Ht,PointerEventInput:mn,TouchMouseInput:gn,SingleTouchInput:ri,Recognizer:Ye,AttrRecognizer:Re,Tap:Kt,Pan:Qt,Swipe:En,Pinch:_n,Rotate:Tn,Press:bn,on:Z,off:j,each:T,merge:ne,extend:H,assign:w,inherit:W,bindFn:V,prefixed:M});var _r=typeof e<"u"?e:typeof self<"u"?self:{};_r.Hammer=Ue,typeof r=="function"&&r.amd?r(function(){return Ue}):n.exports?n.exports=Ue:e[i]=Ue})(window,document,"Hammer")})(gs);const wt=gs.exports;/*!
* chartjs-plugin-zoom v2.0.0
* undefined
 * (c) 2016-2022 chartjs-plugin-zoom Contributors
 * Released under the MIT License
 */const Dt=n=>n&&n.enabled&&n.modifierKey,ys=(n,e)=>n&&e[n+"Key"],Vn=(n,e)=>n&&!e[n+"Key"];function Ze(n,e,t){return n===void 0?!0:typeof n=="string"?n.indexOf(e)!==-1:typeof n=="function"?n({chart:t}).indexOf(e)!==-1:!1}function xn(n,e){return typeof n=="function"&&(n=n({chart:e})),typeof n=="string"?{x:n.indexOf("x")!==-1,y:n.indexOf("y")!==-1}:{x:!1,y:!1}}function Qo(n,e){let t;return function(){return clearTimeout(t),t=setTimeout(n,e),e}}function Ko({x:n,y:e},t){const i=t.scales,r=Object.keys(i);for(let s=0;s<r.length;s++){const c=i[r[s]];if(e>=c.top&&e<=c.bottom&&n>=c.left&&n<=c.right)return c}return null}function vs(n,e,t){const{mode:i="xy",scaleMode:r,overScaleMode:s}=n||{},c=Ko(e,t),p=xn(i,t),f=xn(r,t);if(s){const _=xn(s,t);for(const b of["x","y"])_[b]&&(f[b]=p[b],p[b]=!1)}if(c&&f[c.axis])return[c];const v=[];return et(t.scales,function(_){p[_.axis]&&v.push(_)}),v}const Pn=new WeakMap;function te(n){let e=Pn.get(n);return e||(e={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{}},Pn.set(n,e)),e}function $o(n){Pn.delete(n)}function _s(n,e,t){const i=n.max-n.min,r=i*(e-1),s=n.isHorizontal()?t.x:t.y,c=Math.max(0,Math.min(1,(n.getValueForPixel(s)-n.min)/i||0)),p=1-c;return{min:r*c,max:r*p}}function Ai(n,e,t,i,r){let s=t[i];if(s==="original"){const c=n.originalScaleLimits[e.id][i];s=cn(c.options,c.scale)}return cn(s,r)}function Go(n,e,t){const i=n.getValueForPixel(e),r=n.getValueForPixel(t);return{min:Math.min(i,r),max:Math.max(i,r)}}function gt(n,{min:e,max:t},i,r=!1){const s=te(n.chart),{id:c,axis:p,options:f}=n,v=i&&(i[c]||i[p])||{},{minRange:_=0}=v,b=Ai(s,n,v,"min",-1/0),k=Ai(s,n,v,"max",1/0),T=Math.max(e,b),P=Math.min(t,k),w=r?Math.max(P-T,_):n.max-n.min;if(P-T!==w)if(b>P-w)e=T,t=T+w;else if(k<T+w)t=P,e=P-w;else{const H=(w-P+T)/2;e=T-H,t=P+H}else e=T,t=P;return f.min=e,f.max=t,s.updatedScaleLimits[n.id]={min:e,max:t},n.parse(e)!==n.min||n.parse(t)!==n.max}function Zo(n,e,t,i){const r=_s(n,e,t),s={min:n.min+r.min,max:n.max-r.max};return gt(n,s,i,!0)}function Jo(n,e,t,i){gt(n,Go(n,e,t),i,!0)}const Pi=n=>n===0||isNaN(n)?0:n<0?Math.min(Math.round(n),-1):Math.max(Math.round(n),1);function ea(n){const t=n.getLabels().length-1;n.min>0&&(n.min-=1),n.max<t&&(n.max+=1)}function ta(n,e,t,i){const r=_s(n,e,t);n.min===n.max&&e<1&&ea(n);const s={min:n.min+Pi(r.min),max:n.max-Pi(r.max)};return gt(n,s,i,!0)}function na(n){return n.isHorizontal()?n.width:n.height}function ia(n,e,t){const r=n.getLabels().length-1;let{min:s,max:c}=n;const p=Math.max(c-s,1),f=Math.round(na(n)/Math.max(p,10)),v=Math.round(Math.abs(e/f));let _;return e<-f?(c=Math.min(c+v,r),s=p===1?c:c-p,_=c===r):e>f&&(s=Math.max(0,s-v),c=p===1?s:s+p,_=s===0),gt(n,{min:s,max:c},t)||_}const sa={second:500,minute:30*1e3,hour:30*60*1e3,day:12*60*60*1e3,week:3.5*24*60*60*1e3,month:15*24*60*60*1e3,quarter:60*24*60*60*1e3,year:182*24*60*60*1e3};function bs(n,e,t,i=!1){const{min:r,max:s,options:c}=n,p=c.time&&c.time.round,f=sa[p]||0,v=n.getValueForPixel(n.getPixelForValue(r+f)-e),_=n.getValueForPixel(n.getPixelForValue(s+f)-e),{min:b=-1/0,max:k=1/0}=i&&t&&t[n.axis]||{};return isNaN(v)||isNaN(_)||v<b||_>k?!0:gt(n,{min:v,max:_},t,i)}function Ni(n,e,t){return bs(n,e,t,!0)}const Nn={category:ta,default:Zo},Rn={default:Jo},On={category:ia,default:bs,logarithmic:Ni,timeseries:Ni};function ra(n,e,t){const{id:i,options:{min:r,max:s}}=n;if(!e[i]||!t[i])return!0;const c=t[i];return c.min!==r||c.max!==s}function Ri(n,e){et(n,(t,i)=>{e[i]||delete n[i]})}function zt(n,e){const{scales:t}=n,{originalScaleLimits:i,updatedScaleLimits:r}=e;return et(t,function(s){ra(s,i,r)&&(i[s.id]={min:{scale:s.min,options:s.options.min},max:{scale:s.max,options:s.options.max}})}),Ri(i,t),Ri(r,t),i}function Oi(n,e,t,i){const r=Nn[n.type]||Nn.default;ae(r,[n,e,t,i])}function Ii(n,e,t,i,r){const s=Rn[n.type]||Rn.default;ae(s,[n,e,t,i,r])}function oa(n){const e=n.chartArea;return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}function Xn(n,e,t="none"){const{x:i=1,y:r=1,focalPoint:s=oa(n)}=typeof e=="number"?{x:e,y:e}:e,c=te(n),{options:{limits:p,zoom:f}}=c;zt(n,c);const v=i!==1,_=r!==1,b=vs(f,s,n);et(b||n.scales,function(k){k.isHorizontal()&&v?Oi(k,i,s,p):!k.isHorizontal()&&_&&Oi(k,r,s,p)}),n.update(t),ae(f.onZoom,[{chart:n}])}function Ts(n,e,t,i="none"){const r=te(n),{options:{limits:s,zoom:c}}=r,{mode:p="xy"}=c;zt(n,r);const f=Ze(p,"x",n),v=Ze(p,"y",n);et(n.scales,function(_){_.isHorizontal()&&f?Ii(_,e.x,t.x,s):!_.isHorizontal()&&v&&Ii(_,e.y,t.y,s)}),n.update(i),ae(c.onZoom,[{chart:n}])}function aa(n,e,t,i="none"){zt(n,te(n));const r=n.scales[e];gt(r,t,void 0,!0),n.update(i)}function ca(n,e="default"){const t=te(n),i=zt(n,t);et(n.scales,function(r){const s=r.options;i[r.id]?(s.min=i[r.id].min.options,s.max=i[r.id].max.options):(delete s.min,delete s.max)}),n.update(e),ae(t.options.zoom.onZoomComplete,[{chart:n}])}function la(n,e){const t=n.originalScaleLimits[e];if(!t)return;const{min:i,max:r}=t;return cn(r.options,r.scale)-cn(i.options,i.scale)}function ua(n){const e=te(n);let t=1,i=1;return et(n.scales,function(r){const s=la(e,r.id);if(s){const c=Math.round(s/(r.max-r.min)*100)/100;t=Math.min(t,c),i=Math.max(i,c)}}),t<1?t:i}function Li(n,e,t,i){const{panDelta:r}=i,s=r[n.id]||0;xi(s)===xi(e)&&(e+=s);const c=On[n.type]||On.default;ae(c,[n,e,t])?r[n.id]=0:r[n.id]=e}function Es(n,e,t,i="none"){const{x:r=0,y:s=0}=typeof e=="number"?{x:e,y:e}:e,c=te(n),{options:{pan:p,limits:f}}=c,{onPan:v}=p||{};zt(n,c);const _=r!==0,b=s!==0;et(t||n.scales,function(k){k.isHorizontal()&&_?Li(k,r,f,c):!k.isHorizontal()&&b&&Li(k,s,f,c)}),n.update(i),ae(v,[{chart:n}])}function Ss(n){const e=te(n),t={};for(const i of Object.keys(n.scales)){const{min:r,max:s}=e.originalScaleLimits[i]||{min:{},max:{}};t[i]={min:r.scale,max:s.scale}}return t}function ha(n){const e=Ss(n);for(const t of Object.keys(n.scales)){const{min:i,max:r}=e[t];if(i!==void 0&&n.scales[t].min!==i||r!==void 0&&n.scales[t].max!==r)return!0}return!1}function ve(n,e){const{handlers:t}=te(n),i=t[e];i&&i.target&&(i.target.removeEventListener(e,i),delete t[e])}function At(n,e,t,i){const{handlers:r,options:s}=te(n),c=r[t];c&&c.target===e||(ve(n,t),r[t]=p=>i(n,p,s),r[t].target=e,e.addEventListener(t,r[t]))}function fa(n,e){const t=te(n);t.dragStart&&(t.dragging=!0,t.dragEnd=e,n.update("none"))}function da(n,e){const t=te(n);!t.dragStart||e.key!=="Escape"||(ve(n,"keydown"),t.dragging=!1,t.dragStart=t.dragEnd=null,n.update("none"))}function xs(n,e,t){const{onZoomStart:i,onZoomRejected:r}=t;if(i){const{left:s,top:c}=e.target.getBoundingClientRect(),p={x:e.clientX-s,y:e.clientY-c};if(ae(i,[{chart:n,event:e,point:p}])===!1)return ae(r,[{chart:n,event:e}]),!1}}function pa(n,e){const t=te(n),{pan:i,zoom:r={}}=t.options;if(e.button!==0||ys(Dt(i),e)||Vn(Dt(r.drag),e))return ae(r.onZoomRejected,[{chart:n,event:e}]);xs(n,e,r)!==!1&&(t.dragStart=e,At(n,n.canvas,"mousemove",fa),At(n,window.document,"keydown",da))}function ks(n,e,t,i){const{left:r,top:s}=t.target.getBoundingClientRect(),c=Ze(e,"x",n),p=Ze(e,"y",n);let{top:f,left:v,right:_,bottom:b,width:k,height:T}=n.chartArea;c&&(v=Math.min(t.clientX,i.clientX)-r,_=Math.max(t.clientX,i.clientX)-r),p&&(f=Math.min(t.clientY,i.clientY)-s,b=Math.max(t.clientY,i.clientY)-s);const P=_-v,w=b-f;return{left:v,top:f,right:_,bottom:b,width:P,height:w,zoomX:c&&P?1+(k-P)/k:1,zoomY:p&&w?1+(T-w)/T:1}}function ma(n,e){const t=te(n);if(!t.dragStart)return;ve(n,"mousemove");const{mode:i,onZoomComplete:r,drag:{threshold:s=0}}=t.options.zoom,c=ks(n,i,t.dragStart,e),p=Ze(i,"x",n)?c.width:0,f=Ze(i,"y",n)?c.height:0,v=Math.sqrt(p*p+f*f);if(t.dragStart=t.dragEnd=null,v<=s){t.dragging=!1,n.update("none");return}Ts(n,{x:c.left,y:c.top},{x:c.right,y:c.bottom},"zoom"),setTimeout(()=>t.dragging=!1,500),ae(r,[{chart:n}])}function ga(n,e,t){if(Vn(Dt(t.wheel),e)){ae(t.onZoomRejected,[{chart:n,event:e}]);return}if(xs(n,e,t)!==!1&&(e.cancelable&&e.preventDefault(),e.deltaY!==void 0))return!0}function ya(n,e){const{handlers:{onZoomComplete:t},options:{zoom:i}}=te(n);if(!ga(n,e,i))return;const r=e.target.getBoundingClientRect(),s=1+(e.deltaY>=0?-i.wheel.speed:i.wheel.speed),c={x:s,y:s,focalPoint:{x:e.clientX-r.left,y:e.clientY-r.top}};Xn(n,c),t&&t()}function va(n,e,t,i){t&&(te(n).handlers[e]=Qo(()=>ae(t,[{chart:n}]),i))}function _a(n,e){const t=n.canvas,{wheel:i,drag:r,onZoomComplete:s}=e.zoom;i.enabled?(At(n,t,"wheel",ya),va(n,"onZoomComplete",s,250)):ve(n,"wheel"),r.enabled?(At(n,t,"mousedown",pa),At(n,t.ownerDocument,"mouseup",ma)):(ve(n,"mousedown"),ve(n,"mousemove"),ve(n,"mouseup"),ve(n,"keydown"))}function ba(n){ve(n,"mousedown"),ve(n,"mousemove"),ve(n,"mouseup"),ve(n,"wheel"),ve(n,"click"),ve(n,"keydown")}function Ta(n,e){return function(t,i){const{pan:r,zoom:s={}}=e.options;if(!r||!r.enabled)return!1;const c=i&&i.srcEvent;return c&&!e.panning&&i.pointerType==="mouse"&&(Vn(Dt(r),c)||ys(Dt(s.drag),c))?(ae(r.onPanRejected,[{chart:n,event:i}]),!1):!0}}function Ea(n,e){const t=Math.abs(n.clientX-e.clientX),i=Math.abs(n.clientY-e.clientY),r=t/i;let s,c;return r>.3&&r<1.7?s=c=!0:t>i?s=!0:c=!0,{x:s,y:c}}function Cs(n,e,t){if(e.scale){const{center:i,pointers:r}=t,s=1/e.scale*t.scale,c=t.target.getBoundingClientRect(),p=Ea(r[0],r[1]),f=e.options.zoom.mode,v={x:p.x&&Ze(f,"x",n)?s:1,y:p.y&&Ze(f,"y",n)?s:1,focalPoint:{x:i.x-c.left,y:i.y-c.top}};Xn(n,v),e.scale=t.scale}}function Sa(n,e){e.options.zoom.pinch.enabled&&(e.scale=1)}function xa(n,e,t){e.scale&&(Cs(n,e,t),e.scale=null,ae(e.options.zoom.onZoomComplete,[{chart:n}]))}function ws(n,e,t){const i=e.delta;i&&(e.panning=!0,Es(n,{x:t.deltaX-i.x,y:t.deltaY-i.y},e.panScales),e.delta={x:t.deltaX,y:t.deltaY})}function ka(n,e,t){const{enabled:i,onPanStart:r,onPanRejected:s}=e.options.pan;if(!i)return;const c=t.target.getBoundingClientRect(),p={x:t.center.x-c.left,y:t.center.y-c.top};if(ae(r,[{chart:n,event:t,point:p}])===!1)return ae(s,[{chart:n,event:t}]);e.panScales=vs(e.options.pan,p,n),e.delta={x:0,y:0},clearTimeout(e.panEndTimeout),ws(n,e,t)}function Ca(n,e){e.delta=null,e.panning&&(e.panEndTimeout=setTimeout(()=>e.panning=!1,500),ae(e.options.pan.onPanComplete,[{chart:n}]))}const In=new WeakMap;function wa(n,e){const t=te(n),i=n.canvas,{pan:r,zoom:s}=e,c=new wt.Manager(i);s&&s.pinch.enabled&&(c.add(new wt.Pinch),c.on("pinchstart",()=>Sa(n,t)),c.on("pinch",p=>Cs(n,t,p)),c.on("pinchend",p=>xa(n,t,p))),r&&r.enabled&&(c.add(new wt.Pan({threshold:r.threshold,enable:Ta(n,t)})),c.on("panstart",p=>ka(n,t,p)),c.on("panmove",p=>ws(n,t,p)),c.on("panend",()=>Ca(n,t))),In.set(n,c)}function Aa(n){const e=In.get(n);e&&(e.remove("pinchstart"),e.remove("pinch"),e.remove("pinchend"),e.remove("panstart"),e.remove("pan"),e.remove("panend"),e.destroy(),In.delete(n))}var Pa="2.0.0";function $t(n,e,t){const i=t.zoom.drag,{dragStart:r,dragEnd:s}=te(n);if(i.drawTime!==e||!s)return;const{left:c,top:p,width:f,height:v}=ks(n,t.zoom.mode,r,s),_=n.ctx;_.save(),_.beginPath(),_.fillStyle=i.backgroundColor||"rgba(225,225,225,0.3)",_.fillRect(c,p,f,v),i.borderWidth>0&&(_.lineWidth=i.borderWidth,_.strokeStyle=i.borderColor||"rgba(225,225,225)",_.strokeRect(c,p,f,v)),_.restore()}var Na={id:"zoom",version:Pa,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(n,e,t){const i=te(n);i.options=t,Object.prototype.hasOwnProperty.call(t.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(t.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(t.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),wt&&wa(n,t),n.pan=(r,s,c)=>Es(n,r,s,c),n.zoom=(r,s)=>Xn(n,r,s),n.zoomRect=(r,s,c)=>Ts(n,r,s,c),n.zoomScale=(r,s,c)=>aa(n,r,s,c),n.resetZoom=r=>ca(n,r),n.getZoomLevel=()=>ua(n),n.getInitialScaleBounds=()=>Ss(n),n.isZoomedOrPanned=()=>ha(n)},beforeEvent(n){const e=te(n);if(e.panning||e.dragging)return!1},beforeUpdate:function(n,e,t){const i=te(n);i.options=t,_a(n,t)},beforeDatasetsDraw(n,e,t){$t(n,"beforeDatasetsDraw",t)},afterDatasetsDraw(n,e,t){$t(n,"afterDatasetsDraw",t)},beforeDraw(n,e,t){$t(n,"beforeDraw",t)},afterDraw(n,e,t){$t(n,"afterDraw",t)},stop:function(n){ba(n),wt&&Aa(n),$o(n)},panFunctions:On,zoomFunctions:Nn,zoomRectFunctions:Rn};fo.register(po,mo,go,yo,vo,_o,bo,To,Na);const Tt=mt.forwardRef(({data:n,options:e,labels:t,icon:i,stepSize:r=10,isLoaded:s=!1,timeLine:c="",measure:p="",title:f=""},v)=>{const _=I.exports.useRef({responsive:!0,plugins:{legend:{display:!1},tooltip:{callbacks:{label:T=>{let P="";return T.parsed.y?P=`${T.parsed.y}`:P="0",P},title(){return""}}},zoom:{pan:{enabled:!0,mode:"x"},zoom:{pinch:{enabled:!0},wheel:{enabled:!0},mode:"x"}}},scales:{x:{grid:{display:!1},min:0,max:6,beginAtZero:!0},y:{grid:{display:!0,borderDash:[8,4],color:ee.areaChart.gridColor},ticks:{stepSize:r}}}}),b={labels:t,datasets:[{data:n,fill:!0,borderColor:ee.areaChart.borderLine,pointRadius:4,pointHoverRadius:4,pointBackgroundColor:ee.primary,backgroundColor:T=>{const{ctx:P}=T.chart,w=P.createLinearGradient(0,0,0,200);return w.addColorStop(0,ee.areaChart.start),w.addColorStop(.5,ee.areaChart.middle),w.addColorStop(1,ee.areaChart.end),w}}]},k=I.exports.useRef({id:"empty chart",afterDraw(T){if(T.data.datasets[0].data.length<1){const{ctx:P}=T;P.fillStyle=ee.primary;const{width:w}=T,{height:H}=T;P.textAlign="center",P.textBaseline="middle",P.font="bold 16px Manrope",P.fillText("No data to display",w/2,H/2),P.restore()}}});return E(Se,{children:[E(wn,{spacing:4,mb:8,children:[i&&i,E(He,{children:[E(wn,{children:[E(at,{variant:"title",children:[f," "]}),l(q,{color:"primary",fontWeight:"700",children:c})]}),l(q,{color:"neutral.400",fontSize:"12px",children:p})]})]}),l(Qe.AreaChart,{isLoaded:s,children:l(He,{children:l(Eo,{ref:v,options:e||_.current,plugins:[k.current],data:b,redraw:!0})})})]})});function Ra(n){return lt(Pe({url:Y.ACTUAL_HEALTH_DATA,method:"GET",params:n}))}function Oa({configs:n,special_id:e,timeStamp:t}){const i="from_date"in t?{from_date:t.from_date,to_date:t.to_date}:{type:t.type},{queryParams:r,...s}=hn({special_id:e,...i}),{data:c,...p}=ct({...n,queryFn:()=>Ra(r),queryKey:[Y.ACTUAL_HEALTH_DATA,r]});return{actualData:I.exports.useMemo(()=>c,[c]),queryParams:r,...p,...s}}const As=Rr({displayName:"Health",viewBox:"0 0 24 24",path:E(Se,{children:[l("path",{fill:"currentColor",d:"M22 7.81v4.69h-4.08c-.12-.01-.38-.16-.44-.27l-1.04-1.97c-.41-.78-1.12-1.22-1.88-1.18-.76.04-1.41.55-1.74 1.38l-1.38 3.46-.2-.52c-.49-1.27-1.89-2.23-3.27-2.23L2 11.2V7.81C2 4.17 4.17 2 7.81 2h8.38C19.83 2 22 4.17 22 7.81z"}),l("path",{fill:"currentColor",d:"M22 16.19V14h-4.08c-.67 0-1.46-.48-1.77-1.07l-1.04-1.97c-.28-.53-.68-.5-.9.05l-2.3 5.81c-.25.65-.67.65-.93 0l-1.14-2.88c-.27-.7-1.11-1.27-1.86-1.27L2 12.7v3.49c0 3.58 2.1 5.74 5.63 5.8.11.01.23.01.34.01h8c.15 0 .3 0 .44-.01 3.51-.08 5.59-2.23 5.59-5.8zM2 12.7v3.31c-.02-.32-.03-.66-.03-1.01v-2.3H2z"})]})});function Ln(n){return Ln=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ln(n)}function le(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Mi(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function ue(n,e,t){return e&&Mi(n.prototype,e),t&&Mi(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function Mn(){return Mn=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Mn.apply(this,arguments)}function xe(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Dn(n,e)}function ln(n){return ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},ln(n)}function Dn(n,e){return Dn=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},Dn(n,e)}function Ia(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function La(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Ma(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return La(n)}function ke(n){var e=Ia();return function(){var i=ln(n),r;if(e){var s=ln(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return Ma(this,r)}}var jn=function(){function n(){le(this,n)}return ue(n,[{key:"listenForWhisper",value:function(t,i){return this.listen(".client-"+t,i)}},{key:"notification",value:function(t){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",t)}},{key:"stopListeningForWhisper",value:function(t,i){return this.stopListening(".client-"+t,i)}}]),n}(),Ps=function(){function n(e){le(this,n),this.setNamespace(e)}return ue(n,[{key:"format",value:function(t){return t.charAt(0)==="."||t.charAt(0)==="\\"?t.substr(1):(this.namespace&&(t=this.namespace+"."+t),t.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(t){this.namespace=t}}]),n}(),fn=function(n){xe(t,n);var e=ke(t);function t(i,r,s){var c;return le(this,t),c=e.call(this),c.name=r,c.pusher=i,c.options=s,c.eventFormatter=new Ps(c.options.namespace),c.subscribe(),c}return ue(t,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(r,s){return this.on(this.eventFormatter.format(r),s),this}},{key:"listenToAll",value:function(r){var s=this;return this.subscription.bind_global(function(c,p){if(!c.startsWith("pusher:")){var f=s.options.namespace.replace(/\./g,"\\"),v=c.startsWith(f)?c.substring(f.length+1):"."+c;r(v,p)}}),this}},{key:"stopListening",value:function(r,s){return s?this.subscription.unbind(this.eventFormatter.format(r),s):this.subscription.unbind(this.eventFormatter.format(r)),this}},{key:"stopListeningToAll",value:function(r){return r?this.subscription.unbind_global(r):this.subscription.unbind_global(),this}},{key:"subscribed",value:function(r){return this.on("pusher:subscription_succeeded",function(){r()}),this}},{key:"error",value:function(r){return this.on("pusher:subscription_error",function(s){r(s)}),this}},{key:"on",value:function(r,s){return this.subscription.bind(r,s),this}}]),t}(jn),Da=function(n){xe(t,n);var e=ke(t);function t(){return le(this,t),e.apply(this,arguments)}return ue(t,[{key:"whisper",value:function(r,s){return this.pusher.channels.channels[this.name].trigger("client-".concat(r),s),this}}]),t}(fn),Ba=function(n){xe(t,n);var e=ke(t);function t(){return le(this,t),e.apply(this,arguments)}return ue(t,[{key:"whisper",value:function(r,s){return this.pusher.channels.channels[this.name].trigger("client-".concat(r),s),this}}]),t}(fn),Fa=function(n){xe(t,n);var e=ke(t);function t(){return le(this,t),e.apply(this,arguments)}return ue(t,[{key:"here",value:function(r){return this.on("pusher:subscription_succeeded",function(s){r(Object.keys(s.members).map(function(c){return s.members[c]}))}),this}},{key:"joining",value:function(r){return this.on("pusher:member_added",function(s){r(s.info)}),this}},{key:"leaving",value:function(r){return this.on("pusher:member_removed",function(s){r(s.info)}),this}},{key:"whisper",value:function(r,s){return this.pusher.channels.channels[this.name].trigger("client-".concat(r),s),this}}]),t}(fn),Ns=function(n){xe(t,n);var e=ke(t);function t(i,r,s){var c;return le(this,t),c=e.call(this),c.events={},c.listeners={},c.name=r,c.socket=i,c.options=s,c.eventFormatter=new Ps(c.options.namespace),c.subscribe(),c}return ue(t,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(r,s){return this.on(this.eventFormatter.format(r),s),this}},{key:"stopListening",value:function(r,s){return this.unbindEvent(this.eventFormatter.format(r),s),this}},{key:"subscribed",value:function(r){return this.on("connect",function(s){r(s)}),this}},{key:"error",value:function(r){return this}},{key:"on",value:function(r,s){var c=this;return this.listeners[r]=this.listeners[r]||[],this.events[r]||(this.events[r]=function(p,f){c.name===p&&c.listeners[r]&&c.listeners[r].forEach(function(v){return v(f)})},this.socket.on(r,this.events[r])),this.listeners[r].push(s),this}},{key:"unbind",value:function(){var r=this;Object.keys(this.events).forEach(function(s){r.unbindEvent(s)})}},{key:"unbindEvent",value:function(r,s){this.listeners[r]=this.listeners[r]||[],s&&(this.listeners[r]=this.listeners[r].filter(function(c){return c!==s})),(!s||this.listeners[r].length===0)&&(this.events[r]&&(this.socket.removeListener(r,this.events[r]),delete this.events[r]),delete this.listeners[r])}}]),t}(jn),Rs=function(n){xe(t,n);var e=ke(t);function t(){return le(this,t),e.apply(this,arguments)}return ue(t,[{key:"whisper",value:function(r,s){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(r),data:s}),this}}]),t}(Ns),qa=function(n){xe(t,n);var e=ke(t);function t(){return le(this,t),e.apply(this,arguments)}return ue(t,[{key:"here",value:function(r){return this.on("presence:subscribed",function(s){r(s.map(function(c){return c.user_info}))}),this}},{key:"joining",value:function(r){return this.on("presence:joining",function(s){return r(s.user_info)}),this}},{key:"leaving",value:function(r){return this.on("presence:leaving",function(s){return r(s.user_info)}),this}}]),t}(Rs),un=function(n){xe(t,n);var e=ke(t);function t(){return le(this,t),e.apply(this,arguments)}return ue(t,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(r,s){return this}},{key:"stopListening",value:function(r,s){return this}},{key:"subscribed",value:function(r){return this}},{key:"error",value:function(r){return this}},{key:"on",value:function(r,s){return this}}]),t}(jn),za=function(n){xe(t,n);var e=ke(t);function t(){return le(this,t),e.apply(this,arguments)}return ue(t,[{key:"whisper",value:function(r,s){return this}}]),t}(un),Ya=function(n){xe(t,n);var e=ke(t);function t(){return le(this,t),e.apply(this,arguments)}return ue(t,[{key:"here",value:function(r){return this}},{key:"joining",value:function(r){return this}},{key:"leaving",value:function(r){return this}},{key:"whisper",value:function(r,s){return this}}]),t}(un),Qn=function(){function n(e){le(this,n),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},broadcaster:"pusher",csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(e),this.connect()}return ue(n,[{key:"setOptions",value:function(t){this.options=Mn(this._defaultOptions,t);var i=this.csrfToken();return i&&(this.options.auth.headers["X-CSRF-TOKEN"]=i,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=i),i=this.options.bearerToken,i&&(this.options.auth.headers.Authorization="Bearer "+i,this.options.userAuthentication.headers.Authorization="Bearer "+i),t}},{key:"csrfToken",value:function(){var t;return typeof window<"u"&&window.Laravel&&window.Laravel.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&typeof document.querySelector=="function"&&(t=document.querySelector('meta[name="csrf-token"]'))?t.getAttribute("content"):null}}]),n}(),Ua=function(n){xe(t,n);var e=ke(t);function t(){var i;return le(this,t),i=e.apply(this,arguments),i.channels={},i}return ue(t,[{key:"connect",value:function(){typeof this.options.client<"u"?this.pusher=this.options.client:this.pusher=new Pusher(this.options.key,this.options)}},{key:"signin",value:function(){this.pusher.signin()}},{key:"listen",value:function(r,s,c){return this.channel(r).listen(s,c)}},{key:"channel",value:function(r){return this.channels[r]||(this.channels[r]=new fn(this.pusher,r,this.options)),this.channels[r]}},{key:"privateChannel",value:function(r){return this.channels["private-"+r]||(this.channels["private-"+r]=new Da(this.pusher,"private-"+r,this.options)),this.channels["private-"+r]}},{key:"encryptedPrivateChannel",value:function(r){return this.channels["private-encrypted-"+r]||(this.channels["private-encrypted-"+r]=new Ba(this.pusher,"private-encrypted-"+r,this.options)),this.channels["private-encrypted-"+r]}},{key:"presenceChannel",value:function(r){return this.channels["presence-"+r]||(this.channels["presence-"+r]=new Fa(this.pusher,"presence-"+r,this.options)),this.channels["presence-"+r]}},{key:"leave",value:function(r){var s=this,c=[r,"private-"+r,"private-encrypted-"+r,"presence-"+r];c.forEach(function(p,f){s.leaveChannel(p)})}},{key:"leaveChannel",value:function(r){this.channels[r]&&(this.channels[r].unsubscribe(),delete this.channels[r])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}]),t}(Qn),Ha=function(n){xe(t,n);var e=ke(t);function t(){var i;return le(this,t),i=e.apply(this,arguments),i.channels={},i}return ue(t,[{key:"connect",value:function(){var r=this,s=this.getSocketIO();return this.socket=s(this.options.host,this.options),this.socket.on("reconnect",function(){Object.values(r.channels).forEach(function(c){c.subscribe()})}),this.socket}},{key:"getSocketIO",value:function(){if(typeof this.options.client<"u")return this.options.client;if(typeof io<"u")return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(r,s,c){return this.channel(r).listen(s,c)}},{key:"channel",value:function(r){return this.channels[r]||(this.channels[r]=new Ns(this.socket,r,this.options)),this.channels[r]}},{key:"privateChannel",value:function(r){return this.channels["private-"+r]||(this.channels["private-"+r]=new Rs(this.socket,"private-"+r,this.options)),this.channels["private-"+r]}},{key:"presenceChannel",value:function(r){return this.channels["presence-"+r]||(this.channels["presence-"+r]=new qa(this.socket,"presence-"+r,this.options)),this.channels["presence-"+r]}},{key:"leave",value:function(r){var s=this,c=[r,"private-"+r,"presence-"+r];c.forEach(function(p){s.leaveChannel(p)})}},{key:"leaveChannel",value:function(r){this.channels[r]&&(this.channels[r].unsubscribe(),delete this.channels[r])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}]),t}(Qn),Wa=function(n){xe(t,n);var e=ke(t);function t(){var i;return le(this,t),i=e.apply(this,arguments),i.channels={},i}return ue(t,[{key:"connect",value:function(){}},{key:"listen",value:function(r,s,c){return new un}},{key:"channel",value:function(r){return new un}},{key:"privateChannel",value:function(r){return new za}},{key:"presenceChannel",value:function(r){return new Ya}},{key:"leave",value:function(r){}},{key:"leaveChannel",value:function(r){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}]),t}(Qn),Va=function(){function n(e){le(this,n),this.options=e,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return ue(n,[{key:"channel",value:function(t){return this.connector.channel(t)}},{key:"connect",value:function(){this.options.broadcaster=="pusher"?this.connector=new Ua(this.options):this.options.broadcaster=="socket.io"?this.connector=new Ha(this.options):this.options.broadcaster=="null"?this.connector=new Wa(this.options):typeof this.options.broadcaster=="function"&&(this.connector=new this.options.broadcaster(this.options))}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(t){return this.connector.presenceChannel(t)}},{key:"leave",value:function(t){this.connector.leave(t)}},{key:"leaveChannel",value:function(t){this.connector.leaveChannel(t)}},{key:"listen",value:function(t,i,r){return this.connector.listen(t,i,r)}},{key:"private",value:function(t){return this.connector.privateChannel(t)}},{key:"encryptedPrivate",value:function(t){return this.connector.encryptedPrivateChannel(t)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){typeof Vue=="function"&&Vue.http&&this.registerVueRequestInterceptor(),typeof axios=="function"&&this.registerAxiosRequestInterceptor(),typeof jQuery=="function"&&this.registerjQueryAjaxSetup(),(typeof Turbo>"u"?"undefined":Ln(Turbo))==="object"&&this.registerTurboRequestInterceptor()}},{key:"registerVueRequestInterceptor",value:function(){var t=this;Vue.http.interceptors.push(function(i,r){t.socketId()&&i.headers.set("X-Socket-ID",t.socketId()),r()})}},{key:"registerAxiosRequestInterceptor",value:function(){var t=this;axios.interceptors.request.use(function(i){return t.socketId()&&(i.headers["X-Socket-Id"]=t.socketId()),i})}},{key:"registerjQueryAjaxSetup",value:function(){var t=this;typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter(function(i,r,s){t.socketId()&&s.setRequestHeader("X-Socket-Id",t.socketId())})}},{key:"registerTurboRequestInterceptor",value:function(){var t=this;document.addEventListener("turbo:before-fetch-request",function(i){i.detail.fetchOptions.headers["X-Socket-Id"]=t.socketId()})}}]),n}();const qe=Object.create(null);qe.open="0";qe.close="1";qe.ping="2";qe.pong="3";qe.message="4";qe.upgrade="5";qe.noop="6";const nn=Object.create(null);Object.keys(qe).forEach(n=>{nn[qe[n]]=n});const Xa={type:"error",data:"parser error"},ja=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Qa=typeof ArrayBuffer=="function",Ka=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Os=({type:n,data:e},t,i)=>ja&&e instanceof Blob?t?i(e):Di(e,i):Qa&&(e instanceof ArrayBuffer||Ka(e))?t?i(e):Di(new Blob([e]),i):i(qe[n]+(e||"")),Di=(n,e)=>{const t=new FileReader;return t.onload=function(){const i=t.result.split(",")[1];e("b"+i)},t.readAsDataURL(n)},Bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<Bi.length;n++)xt[Bi.charCodeAt(n)]=n;const $a=n=>{let e=n.length*.75,t=n.length,i,r=0,s,c,p,f;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const v=new ArrayBuffer(e),_=new Uint8Array(v);for(i=0;i<t;i+=4)s=xt[n.charCodeAt(i)],c=xt[n.charCodeAt(i+1)],p=xt[n.charCodeAt(i+2)],f=xt[n.charCodeAt(i+3)],_[r++]=s<<2|c>>4,_[r++]=(c&15)<<4|p>>2,_[r++]=(p&3)<<6|f&63;return v},Ga=typeof ArrayBuffer=="function",Is=(n,e)=>{if(typeof n!="string")return{type:"message",data:Ls(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:Za(n.substring(1),e)}:nn[t]?n.length>1?{type:nn[t],data:n.substring(1)}:{type:nn[t]}:Xa},Za=(n,e)=>{if(Ga){const t=$a(n);return Ls(t,e)}else return{base64:!0,data:n}},Ls=(n,e)=>{switch(e){case"blob":return n instanceof ArrayBuffer?new Blob([n]):n;case"arraybuffer":default:return n}},Ms=String.fromCharCode(30),Ja=(n,e)=>{const t=n.length,i=new Array(t);let r=0;n.forEach((s,c)=>{Os(s,!1,p=>{i[c]=p,++r===t&&e(i.join(Ms))})})},ec=(n,e)=>{const t=n.split(Ms),i=[];for(let r=0;r<t.length;r++){const s=Is(t[r],e);if(i.push(s),s.type==="error")break}return i},Ds=4;function se(n){if(n)return tc(n)}function tc(n){for(var e in se.prototype)n[e]=se.prototype[e];return n}se.prototype.on=se.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};se.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};se.prototype.off=se.prototype.removeListener=se.prototype.removeAllListeners=se.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var i,r=0;r<t.length;r++)if(i=t[r],i===e||i.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+n],this};se.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,r=t.length;i<r;++i)t[i].apply(this,e)}return this};se.prototype.emitReserved=se.prototype.emit;se.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};se.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Ke=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function Bs(n,...e){return e.reduce((t,i)=>(n.hasOwnProperty(i)&&(t[i]=n[i]),t),{})}const nc=setTimeout,ic=clearTimeout;function dn(n,e){e.useNativeTimers?(n.setTimeoutFn=nc.bind(Ke),n.clearTimeoutFn=ic.bind(Ke)):(n.setTimeoutFn=setTimeout.bind(Ke),n.clearTimeoutFn=clearTimeout.bind(Ke))}const sc=1.33;function rc(n){return typeof n=="string"?oc(n):Math.ceil((n.byteLength||n.size)*sc)}function oc(n){let e=0,t=0;for(let i=0,r=n.length;i<r;i++)e=n.charCodeAt(i),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(i++,t+=4);return t}class ac extends Error{constructor(e,t,i){super(e),this.description=t,this.context=i,this.type="TransportError"}}class Fs extends se{constructor(e){super(),this.writable=!1,dn(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t,i){return super.emitReserved("error",new ac(e,t,i)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Is(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}}const qs="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Bn=64,cc={};let Fi=0,Gt=0,qi;function zi(n){let e="";do e=qs[n%Bn]+e,n=Math.floor(n/Bn);while(n>0);return e}function zs(){const n=zi(+new Date);return n!==qi?(Fi=0,qi=n):n+"."+zi(Fi++)}for(;Gt<Bn;Gt++)cc[qs[Gt]]=Gt;function Ys(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function lc(n){let e={},t=n.split("&");for(let i=0,r=t.length;i<r;i++){let s=t[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}let Us=!1;try{Us=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const uc=Us;function Hs(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||uc))return new XMLHttpRequest}catch{}if(!e)try{return new Ke[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function hc(){}const fc=function(){return new Hs({xdomain:!1}).responseType!=null}();class dc extends Fs{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const i=location.protocol==="https:";let r=location.port;r||(r=i?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port,this.xs=e.secure!==i}const t=e&&e.forceBase64;this.supportsBinary=fc&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(i++,this.once("pollComplete",function(){--i||t()})),this.writable||(i++,this.once("drain",function(){--i||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};ec(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Ja(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let i="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=zs()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port);const r=Ys(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(r.length?"?"+r:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new Fe(this.uri(),e)}doWrite(e,t){const i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",(r,s)=>{this.onError("xhr post error",r,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=e}}class Fe extends se{constructor(e,t){super(),dn(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){const e=Bs(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new Hs(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.opts.extraHeaders[i])}}catch{}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{t.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},t.send(this.data)}catch(i){this.setTimeoutFn(()=>{this.onError(i)},0);return}typeof document<"u"&&(this.index=Fe.requestsCount++,Fe.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=hc,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Fe.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}Fe.requestsCount=0;Fe.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Yi);else if(typeof addEventListener=="function"){const n="onpagehide"in Ke?"pagehide":"unload";addEventListener(n,Yi,!1)}}function Yi(){for(let n in Fe.requests)Fe.requests.hasOwnProperty(n)&&Fe.requests[n].abort()}const Ws=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))(),Zt=Ke.WebSocket||Ke.MozWebSocket,Ui=!0,pc="arraybuffer",Hi=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class mc extends Fs{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,i=Hi?{}:Bs(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=Ui&&!Hi?t?new Zt(e,t):new Zt(e):new Zt(e,t,i)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType||pc,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const i=e[t],r=t===e.length-1;Os(i,this.supportsBinary,s=>{const c={};try{Ui&&this.ws.send(s)}catch{}r&&Ws(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let i="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=zs()),this.supportsBinary||(e.b64=1);const r=Ys(e),s=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(r.length?"?"+r:"")}check(){return!!Zt}}const gc={websocket:mc,polling:dc},yc=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,vc=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Fn(n){const e=n,t=n.indexOf("["),i=n.indexOf("]");t!=-1&&i!=-1&&(n=n.substring(0,t)+n.substring(t,i).replace(/:/g,";")+n.substring(i,n.length));let r=yc.exec(n||""),s={},c=14;for(;c--;)s[vc[c]]=r[c]||"";return t!=-1&&i!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=_c(s,s.path),s.queryKey=bc(s,s.query),s}function _c(n,e){const t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&i.splice(0,1),e.slice(-1)=="/"&&i.splice(i.length-1,1),i}function bc(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,r,s){r&&(t[r]=s)}),t}class je extends se{constructor(e,t={}){super(),e&&typeof e=="object"&&(t=e,e=null),e?(e=Fn(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=Fn(t.host).host),dn(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=lc(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Ds,t.transport=e,this.id&&(t.sid=this.id);const i=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new gc[e](i)}open(){let e;if(this.opts.rememberUpgrade&&je.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(e){let t=this.createTransport(e),i=!1;je.priorWebsocketSuccess=!1;const r=()=>{i||(t.send([{type:"ping",data:"probe"}]),t.once("packet",b=>{if(!i)if(b.type==="pong"&&b.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;je.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(_(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const k=new Error("probe error");k.transport=t.name,this.emitReserved("upgradeError",k)}}))};function s(){i||(i=!0,_(),t.close(),t=null)}const c=b=>{const k=new Error("probe error: "+b);k.transport=t.name,s(),this.emitReserved("upgradeError",k)};function p(){c("transport closed")}function f(){c("socket closed")}function v(b){t&&b.name!==t.name&&s()}const _=()=>{t.removeListener("open",r),t.removeListener("error",c),t.removeListener("close",p),this.off("close",f),this.off("upgrading",v)};t.once("open",r),t.once("error",c),t.once("close",p),this.once("close",f),this.once("upgrading",v),t.open()}onOpen(){if(this.readyState="open",je.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){const r=this.writeBuffer[i].data;if(r&&(t+=rc(r)),i>0&&t>this.maxPayload)return this.writeBuffer.slice(0,i);t+=2}return this.writeBuffer}write(e,t,i){return this.sendPacket("message",e,t,i),this}send(e,t,i){return this.sendPacket("message",e,t,i),this}sendPacket(e,t,i,r){if(typeof t=="function"&&(r=t,t=void 0),typeof i=="function"&&(r=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;const s={type:e,data:t,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){je.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let i=0;const r=e.length;for(;i<r;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}}je.protocol=Ds;function Tc(n,e="",t){let i=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),i=Fn(n)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(t&&t.port===i.port?"":":"+i.port),i}const Ec=typeof ArrayBuffer=="function",Sc=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,Vs=Object.prototype.toString,xc=typeof Blob=="function"||typeof Blob<"u"&&Vs.call(Blob)==="[object BlobConstructor]",kc=typeof File=="function"||typeof File<"u"&&Vs.call(File)==="[object FileConstructor]";function Kn(n){return Ec&&(n instanceof ArrayBuffer||Sc(n))||xc&&n instanceof Blob||kc&&n instanceof File}function sn(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,i=n.length;t<i;t++)if(sn(n[t]))return!0;return!1}if(Kn(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return sn(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&sn(n[t]))return!0;return!1}function Cc(n){const e=[],t=n.data,i=n;return i.data=qn(t,e),i.attachments=e.length,{packet:i,buffers:e}}function qn(n,e){if(!n)return n;if(Kn(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let i=0;i<n.length;i++)t[i]=qn(n[i],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=qn(n[i],e));return t}return n}function wc(n,e){return n.data=zn(n.data,e),n.attachments=void 0,n}function zn(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=zn(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=zn(n[t],e));return n}const Ac=5;var B;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(B||(B={}));class Pc{constructor(e){this.replacer=e}encode(e){return(e.type===B.EVENT||e.type===B.ACK)&&sn(e)?(e.type=e.type===B.EVENT?B.BINARY_EVENT:B.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===B.BINARY_EVENT||e.type===B.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Cc(e),i=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(i),r}}class $n extends se{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e),t.type===B.BINARY_EVENT||t.type===B.BINARY_ACK?(this.reconstructor=new Nc(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Kn(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const i={type:Number(e.charAt(0))};if(B[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===B.BINARY_EVENT||i.type===B.BINARY_ACK){const s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const c=e.substring(s,t);if(c!=Number(c)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(c)}if(e.charAt(t+1)==="/"){const s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(s,t)}else i.nsp="/";const r=e.charAt(t+1);if(r!==""&&Number(r)==r){const s=t+1;for(;++t;){const c=e.charAt(t);if(c==null||Number(c)!=c){--t;break}if(t===e.length)break}i.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if($n.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return i}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case B.CONNECT:return typeof t=="object";case B.DISCONNECT:return t===void 0;case B.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case B.EVENT:case B.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case B.ACK:case B.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class Nc{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=wc(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Rc=Object.freeze(Object.defineProperty({__proto__:null,protocol:Ac,get PacketType(){return B},Encoder:Pc,Decoder:$n},Symbol.toStringTag,{value:"Module"}));function Oe(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const Oc=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Xs extends se{constructor(e,t,i){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Oe(e,"open",this.onopen.bind(this)),Oe(e,"packet",this.onpacket.bind(this)),Oe(e,"error",this.onerror.bind(this)),Oe(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Oc.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');t.unshift(e);const i={type:B.EVENT,data:t};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const c=this.ids++,p=t.pop();this._registerAckCallback(c,p),i.id=c}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,t){const i=this.flags.timeout;if(i===void 0){this.acks[e]=t;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&this.sendBuffer.splice(s,1);t.call(this,new Error("operation has timed out"))},i);this.acks[e]=(...s)=>{this.io.clearTimeoutFn(r),t.apply(this,[null,...s])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this.packet({type:B.CONNECT,data:e})}):this.packet({type:B.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case B.CONNECT:if(e.data&&e.data.sid){const r=e.data.sid;this.onconnect(r)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case B.EVENT:case B.BINARY_EVENT:this.onevent(e);break;case B.ACK:case B.BINARY_ACK:this.onack(e);break;case B.DISCONNECT:this.ondisconnect();break;case B.CONNECT_ERROR:this.destroy();const i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const i of t)i.apply(this,e)}super.emit.apply(this,e)}ack(e){const t=this;let i=!1;return function(...r){i||(i=!0,t.packet({type:B.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:B.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const i of t)i.apply(this,e.data)}}}function yt(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}yt.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=(Math.floor(e*10)&1)==0?n-t:n+t}return Math.min(n,this.max)|0};yt.prototype.reset=function(){this.attempts=0};yt.prototype.setMin=function(n){this.ms=n};yt.prototype.setMax=function(n){this.max=n};yt.prototype.setJitter=function(n){this.jitter=n};class Yn extends se{constructor(e,t){var i;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,dn(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((i=t.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new yt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||Rc;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new je(this.uri,this.opts);const t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const r=Oe(t,"open",function(){i.onopen(),e&&e()}),s=Oe(t,"error",c=>{i.cleanup(),i._readyState="closed",this.emitReserved("error",c),e?e(c):i.maybeReconnectOnOpen()});if(this._timeout!==!1){const c=this._timeout;c===0&&r();const p=this.setTimeoutFn(()=>{r(),t.close(),t.emit("error",new Error("timeout"))},c);this.opts.autoUnref&&p.unref(),this.subs.push(function(){clearTimeout(p)})}return this.subs.push(r),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Oe(e,"ping",this.onping.bind(this)),Oe(e,"data",this.ondata.bind(this)),Oe(e,"error",this.onerror.bind(this)),Oe(e,"close",this.onclose.bind(this)),Oe(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Ws(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i||(i=new Xs(this,e,t),this.nsps[e]=i),i}_destroy(e){const t=Object.keys(this.nsps);for(const i of t)if(this.nsps[i].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Et={};function rn(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=Tc(n,e.path||"/socket.io"),i=t.source,r=t.id,s=t.path,c=Et[r]&&s in Et[r].nsps,p=e.forceNew||e["force new connection"]||e.multiplex===!1||c;let f;return p?f=new Yn(i,e):(Et[r]||(Et[r]=new Yn(i,e)),f=Et[r]),t.query&&!e.query&&(e.query=t.queryKey),f.socket(t.path,e)}Object.assign(rn,{Manager:Yn,Socket:Xs,io:rn,connect:rn});let Jt;const Bt={onSetEcho:()=>{const n=Or(),e={broadcaster:"socket.io",host:bi,client:rn,auth:{headers:{Authorization:n}}};Jt=new Va(e),tn.info("SOCKET URL",bi)},listenRealtimeData:(n,e)=>{Jt.private(`patient.health.data.${n}`).listen(".RealtimeHealthData",t=>{tn.info("payload SOCKET",t),e(t)})},removeListenRealtimeData:n=>{Jt.private(`patient.health.data.${n}`).stopListening(".RealtimeHealthData"),Jt.leaveChannel(`patient.health.data.${n}`),tn.info("Disconnected SOCKET","Disconnected")}};C.extend(jo);function Ic({specialId:n=0,patientId:e=0}){const{actualData:t,queryParams:i,setQueryOverride:r,isSuccess:s,isLoading:c}=Oa({timeStamp:{from_date:ye({date:C(new Date).subtract(7,"days"),format:"YYYY-MM-DD"}),to_date:ye({date:C(new Date).subtract(1,"day"),format:"YYYY-MM-DD"})},configs:{enabled:!!n},special_id:n}),[p,f]=I.exports.useState(!1),[v,_]=I.exports.useState(2),[b,k]=I.exports.useState({from:C(i.from_date).toDate(),to:C(i.to_date).toDate()}),T=new Date,P=C(T).startOf("day").toDate(),w=C(T).endOf("day").toDate(),H=C(T).subtract(1,"day").startOf("day").toDate(),ne=C(T).subtract(1,"day").endOf("day").toDate(),W=C().weekday(-6).startOf("day").toDate(),V=C().weekday(0).endOf("day").toDate(),G=C().weekday(1).startOf("day").toDate(),$=C(C(T).endOf("week").toDate()).isAfter(new Date)?C(T).endOf("day").toDate():C(T).endOf("week").toDate(),Z=C().weekday(0).startOf("month").toDate(),j=C(C().weekday(1).endOf("month").toDate()).isAfter(new Date)?C(T).endOf("day").toDate():C(T).endOf("month").toDate(),z=C(T).subtract(1,"month").startOf("month").toDate(),K=C(T).subtract(1,"month").endOf("month").toDate(),d=I.exports.useCallback(({keyData:A,format:O})=>{if(!(t!=null&&t.health_data))return{labels:[],data:[]};const Me=Object.entries(t==null?void 0:t.health_data).reduce((X,[be,Q])=>{if(i.type===ie.BY_LAST_HOURS||i.type===ie.BY_TO_DAY||i.type===ie.BY_5_MINUTES?X.labels.push(be.slice(-2)):X.labels.push(C(be).format(Ir[O])),A==="sleep"){const L=Q[A]/60;X.data.push(Number(Number(L).toFixed(2)))}else X.data.push(Math.floor(Number(Q[A])));return X},{labels:[],data:[]});return{labels:Me.labels,data:Me.data}},[t==null?void 0:t.health_data,i.type]),{t:S}=Je(["common","patients"]),y=[{title:"Last 5 minutes",type:ie.BY_5_MINUTES},{title:"Last 1 hour",type:ie.BY_LAST_HOURS},{title:"Customize"}],m=(A,O)=>C(A).isSame(O),M=(A,O)=>{if(m(C(A).startOf("day").toDate(),P)&&m(C(O).endOf("day").toDate(),w)){r({special_id:i.special_id,type:ie.BY_TO_DAY}),k({from:C(A).toDate(),to:C(O).toDate()}),f(!1);return}if(m(C(A).startOf("day").toDate(),H)&&m(C(O).endOf("day").toDate(),ne)){r({special_id:i.special_id,type:ie.BY_YESTERDAY}),k({from:C(A).toDate(),to:C(O).toDate()}),f(!1);return}if(m(C(A).startOf("day").toDate(),G)&&m(C(O).endOf("day").toDate(),$)){r({special_id:i.special_id,type:ie.BY_THIS_WEEK}),k({from:C(A).toDate(),to:C(O).toDate()}),f(!1);return}if(m(C(A).startOf("day").toDate(),W)&&m(C(O).endOf("day").toDate(),V)){r({special_id:i.special_id,type:ie.BY_LAST_WEEK}),k({from:C(A).toDate(),to:C(O).toDate()}),f(!1);return}if(m(C(A).startOf("day").toDate(),Z)&&m(C(O).endOf("day").toDate(),j)){r({special_id:i.special_id,type:ie.BY_THIS_MONTH}),k({from:C(A).toDate(),to:C(O).toDate()}),f(!1);return}if(m(C(A).startOf("day").toDate(),z)&&m(C(O).endOf("day").toDate(),K)){r({special_id:i.special_id,type:ie.BY_LAST_MONTH}),k({from:C(A).toDate(),to:C(O).toDate()}),f(!1);return}r({special_id:i.special_id,from_date:ye({date:C(A),format:"YYYY-MM-DD"}),to_date:ye({date:C(O),format:"YYYY-MM-DD"})}),k({from:C(A).toDate(),to:C(O).toDate()}),f(!1)},F=A=>A?A===ie.BY_5_MINUTES?"Real time":A===ie.BY_LAST_HOURS?"Last hours":A===ie.BY_TO_DAY?"Today":A===ie.BY_YESTERDAY?"Yesterday":A===ie.BY_THIS_WEEK?"This week":A===ie.BY_LAST_WEEK?"Last week":A===ie.BY_THIS_MONTH?"This month":A===ie.BY_LAST_MONTH?"Last month":"":`${ye({date:C(i.from_date),format:"DD/MM"})} - ${ye({date:C(i.to_date),format:"DD/MM"})}`,[N,We]=I.exports.useState(null);I.exports.useEffect(()=>{if(!s)return;const A={blood_systolic:{data:d({format:"DAY",keyData:"blood_systolic"}).data,labels:d({format:"DAY",keyData:"blood_systolic"}).labels},pulse_oxygenation:{data:d({format:"DAY",keyData:"pulse_oxygenation"}).data,labels:d({format:"DAY",keyData:"pulse_oxygenation"}).labels},pulse:{data:d({format:"DAY",keyData:"pulse"}).data,labels:d({format:"DAY",keyData:"pulse"}).labels},activity:{data:d({format:"DAY",keyData:"activity"}).data,labels:d({format:"DAY",keyData:"activity"}).labels},sleep:{data:d({format:"DAY",keyData:"sleep"}).data,labels:d({format:"DAY",keyData:"sleep"}).labels},blood_diastolic:{labels:[],data:[]},respiration:{labels:[],data:[]},stress_monitor:{labels:[],data:[]},fatigue_monitor:{labels:[],data:[]}};We(A)},[s,d]);const _e=(A,O)=>{var Me,X;A.current&&A.current.data.labels&&(A.current.data.datasets[0].data.push(Number(O)),A.current.data.labels.push(ye({date:C(new Date),format:"mm:ss"})),(Me=A.current)==null||Me.update(),A.current.data.labels.shift(),A.current.data.datasets[0].data.shift(),(X=A.current)==null||X.update())};I.exports.useEffect(()=>(s&&Bt.listenRealtimeData(e,A=>{i.type===ie.BY_5_MINUTES&&A.data.forEach(O=>{O.type===ge.activity&&_e(Ce,O.value),O.type===ge.blood_systolic&&_e(Ne,O.value),O.type===ge.pulse&&_e(nt,O.value),O.type===ge.pulse_oxygenation&&_e(tt,O.value),O.type===ge.sleep&&_e(it,Number((Number(O.value)/60).toFixed(2)))})}),()=>{Bt.removeListenRealtimeData(e)}),[N,s,e,i.type]);const Ce=I.exports.useRef(null),tt=I.exports.useRef(null),nt=I.exports.useRef(null),Ne=I.exports.useRef(null),it=I.exports.useRef(null);return!n||!e?l(Se,{children:S("common:no_data")}):E(R,{spacing:4,children:[E(Lr,{pos:"relative",variant:"outline",spacing:2,py:1,bg:"neutral.600",rounded:8,children:[y.map((A,O)=>A.title==="Customize"?l(re,{px:"16px",_active:{bg:"primary",color:"white"},isActive:O===v,py:2,isDisabled:c,fontSize:{base:"13px",md:"14px"},border:"none",onClick:()=>{_(O),f(!0)},children:A.title},O):l(re,{px:"16px",isDisabled:c,_active:{bg:"primary",color:"white"},isActive:O===v,py:2,fontSize:{base:"13px",md:"14px"},border:"none",onClick:()=>{A.type&&r({type:A.type,special_id:i.special_id}),_(O),f(!1)},children:A.title},O)),p&&l(R,{zIndex:100,rounded:8,mt:4,bg:"white",left:"-8px",right:"0",boxShadow:"1px 0px 4px 1px #ccc",pos:"absolute",top:"100%",children:l(So,{initialDate:b,children:(A,O)=>E(wn,{spacing:{base:4,md:6},pb:{base:4,md:6},justify:"center",children:[l(re,{size:{base:"md",lg:"lg"},variant:"solid",isDisabled:C(A).isSame(C(i.from_date))&&C(O).isSame(C(i.to_date)),onClick:()=>M(A,O),children:"Apply"}),l(re,{bg:"neutral.600",size:{base:"md",lg:"lg"},color:"secondary",_hover:{bg:"indicator.400",color:"white"},onClick:()=>f(!1),children:"Cancel"})]})})})]}),E(Mr,{columns:{base:1,lg:2,xl:3},spacing:10,pt:8,children:[l(He,{children:l(Tt,{ref:Ne,isLoaded:!c,icon:l(Ki,{color:"healthData.indicator0",fontSize:"25px"}),timeLine:F(i.type),title:"Blood Pressure",measure:"(mmHg)",data:(N==null?void 0:N.blood_systolic.data)||[],labels:(N==null?void 0:N.blood_systolic.labels)||[]})}),l(He,{children:l(Tt,{ref:tt,isLoaded:!c,icon:l($i,{color:"indicator.200",fontSize:"25px"}),title:"Oxygenation",timeLine:F(i.type),measure:"(%)",data:(N==null?void 0:N.pulse_oxygenation.data)||[],labels:(N==null?void 0:N.pulse_oxygenation.labels)||[]})}),l(He,{children:l(Tt,{ref:nt,isLoaded:!c,icon:l(As,{color:"healthData.indicator0",fontSize:"25px"}),title:"Pulse",timeLine:F(i.type),measure:"(BPM)",data:(N==null?void 0:N.pulse.data)||[],labels:(N==null?void 0:N.pulse.labels)||[]})}),l(He,{children:l(Tt,{ref:Ce,isLoaded:!c,icon:l(Gi,{color:"neutral.100",fontSize:"25px"}),title:"Step",timeLine:F(i.type),measure:"(Steps)",data:(N==null?void 0:N.activity.data)||[],labels:(N==null?void 0:N.activity.labels)||[]})}),l(He,{children:l(Tt,{ref:it,isLoaded:!c,icon:l(Zi,{color:"healthData.purple",fontSize:"25px"}),title:"Sleep",timeLine:F(i.type),measure:"(Hours)",data:(N==null?void 0:N.sleep.data)||[],labels:(N==null?void 0:N.sleep.labels)||[]})})]})]})}function Lc(n){return Dr({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attr:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]})(n)}function Mc({patientId:n}){var z,K;const{t:e}=Je(["common","patients"]),{patientDetail:t,isLoading:i}=cs({id:n}),{notesList:r,notesPaging:s,isLoading:c,setQuery:p}=Mo({id:n,configs:{enabled:!!n}}),[f,v]=I.exports.useState(0),_=Rt(),b=Nt(),k=Lt({schema:f?Uo:Hn}),T=us(),P=zo(),w=Fo(),{reset:H,clearErrors:ne,isDirtyField:W}=k;function V(d){var S;if(f){P.mutate({note_id:f,content:d.content,patientId:n},{onSuccess(){H(),ne(),v(0)}});return}T.mutate({patient_id:n,content:(S=d.content)!=null?S:""},{onSuccess(){H(),ne()}})}const{user:G}=Br(),{isAdmin:$,isNurse:Z}=Un();function j(d){return $?!0:Z?!(d.user_id!==(G==null?void 0:G.user_id)&&d.role_type===U.Nurse||d.role_type===U.Admin):d.role_type===(G==null?void 0:G.role_type)&&!$&&!Z}return E(R,{mt:4,spacing:6,children:[E(R,{direction:"row",justify:"space-between",children:[E(R,{justify:"space-between",children:[l(at,{variant:"title",children:"Notes for Patient"}),l(q,{fontWeight:500,color:"neutral.300",children:e("common:socket_group.notes_for_patient_from_clinic_team")})]}),l(Ie,{allowedRoles:ji,children:l(re,{leftIcon:l(as,{}),type:"button",isDisabled:c||i,onClick:()=>{var d;(d=_.current)==null||d.openModal(),P.reset(),v(0),H({content:""})},children:l(q,{as:"span",fontSize:"14px",color:"white",fontWeight:600,children:e("common:socket_group.make_note")})})})]}),l(Qe.Note,{isLoaded:!c,children:E(Se,{children:[E(R,{spacing:4,children:[r==null?void 0:r.map(d=>{var S,y,m,M;return E(R,{bg:"neutral.600",p:4,rounded:8,spacing:4,children:[E(R,{spacing:4,direction:"row",justify:"space-between",children:[E(R,{justify:"space-between",children:[l(at,{variant:"title",children:ye({date:d==null?void 0:d.updated_at,format:"MMM DD, YYYY"})}),E(R,{direction:{base:"column",xl:"row"},spacing:6,children:[l(q,{fontWeight:500,color:"neutral.300",children:`Noted by: ${Ee({firstName:(S=d==null?void 0:d.user)==null?void 0:S.first_name,middleName:(y=d==null?void 0:d.user)==null?void 0:y.middle_name,lastName:(m=d==null?void 0:d.user)==null?void 0:m.last_name})} (${(M=d==null?void 0:d.user)==null?void 0:M.role})`}),E(R,{direction:"row",spacing:2,align:"center",children:[l(Ji,{as:Lc,w:5,h:5,color:"neutral.300"}),l(q,{children:ye({date:d.updated_at,format:"hh : mm : A"})})]})]})]}),E(R,{spacing:2,direction:"row",children:[l(Ie,{allowedRoles:Fr,children:j(d.user)&&l(re,{leftIcon:l(qr,{width:"16px",height:"16px"}),variant:"unstyled",display:"flex",alignItems:"center",_hover:{color:"primary"},fontSize:"14px",onClick:()=>{var F;T.reset(),v(d.id),H({content:d.content}),(F=_.current)==null||F.openModal()},children:e("common:edit")})}),l(Ie,{allowedRoles:zr,children:j(d.user)&&E(re,{leftIcon:l(rs,{width:16,height:16}),variant:"unstyled",display:"flex",alignItems:"center",_hover:{color:"primary"},fontSize:"14px",onClick:()=>{var F;(F=b.current)==null||F.show(),v(d.id)},children:[e("common:delete"),l(It,{ref:b,isLoading:w.isLoading,isDone:w.isSuccess,onHandleConfirm:()=>{w.mutate({noteId:f,patientId:n},{onSuccess(){v(0)}})}})]})})]})]}),l(xo,{html:d==null?void 0:d.content})]},d.id)}),l(R,{direction:"row",pt:4,justify:"flex-end",align:"center",spacing:"6",children:r.length>0&&l(An,{totalCount:(s==null?void 0:s.total)||0,currentPage:(s==null?void 0:s.current_page)||1,perPage:Number(s==null?void 0:s.per_page),onPageChange:d=>p({page:d})})})]}),r.length<=0&&n&&!c&&l(q,{textAlign:"center",fontSize:"18px",fontWeight:"bold",children:e("common:no_data")})]})}),l(Ot,{ref:_,title:e(f?"patients:form.update_note_for_patient":"patients:form.make_note_for_patient"),isDone:T.isSuccess||P.isSuccess,renderFooter:()=>l(re,{size:"lg",w:"384px",form:"note-form",type:"submit",isLoading:T.isLoading||P.isLoading,isDisabled:T.isLoading||P.isLoading||!W,children:e(f?"patients:form.update_note":"common:socket_group.make_note")}),children:l(Mt,{form:k,id:"note-form",onSubmit:V,children:l(ps,{patientInfo:{name:Ee({firstName:t==null?void 0:t.first_name,middleName:t==null?void 0:t.middle_name,lastName:t==null?void 0:t.last_name}),avatar:(z=t==null?void 0:t.avatar)!=null?z:"",type:(K=t==null?void 0:t.type)!=null?K:0},mt:3.5})})})]})}const Dc=mt.memo(Mc);function Bc(n){return`patients/${n}/stroke-risk`}function Fc(n){return lt(Pe({url:Bc(n),method:"GET"}))}function qc({id:n,configs:e}){const{data:t,...i}=ct({...e,queryFn:()=>Fc(n),queryKey:[n]});return{strokeRiskData:I.exports.useMemo(()=>t==null?void 0:t.stroke_risk,[t==null?void 0:t.stroke_risk]),...i}}const zc=n=>{const{Icon:e,params:t="",title:i="",unit:r=""}=n;return E(R,{align:"center",direction:"row",py:2,justify:"space-between",borderBottom:"1px",borderColor:"neutral.600",children:[E(R,{align:"center",direction:"row",spacing:5,children:[e&&e,l(q,{sx:{fontWeight:"600",fontSize:"15px",lineHeight:"20px"},color:i==="Respiration"?"gray":"neutral.100",children:i})]}),E(R,{align:"center",spacing:1,direction:"row",w:"110px",children:[l(q,{sx:{fontWeight:"700",fontSize:"18px",lineHeight:"25px"},color:"neutral.100",children:t!=null?t:"No data"}),l(q,{sx:{fontWeight:"500",fontSize:"13px",lineHeight:"16px"},color:"neutral.300",children:r})]})]})},Yc=({healthParamsData:n})=>l(R,{spacing:3,children:n.map((e,t)=>{const{Icon:i}=e;return l(zc,{Icon:l(Ji,{as:i,w:"20px",h:"20px",color:e.color}),title:e.title,params:e.params,unit:e.unit},t)})}),Uc=n=>n?n===1?ee.strokeRisk.normal:n===2?ee.strokeRisk.elevated:n===3?ee.strokeRisk.quiteHigh:n===4?ee.strokeRisk.high:ee.strokeRisk.dangerous:ee.strokeRisk.normal,Hc=n=>n>=95?ee.healthData.indicator0:n>=93?ee.healthData.lightYellow:ee.healthData.lightRed,Wc=n=>n<140?ee.healthData.indicator0:n>=140&&n<=160?ee.healthData.blue:n>160&&n<=170?ee.healthData.lightYellow:n>170&&n<=180?ee.healthData.orange:ee.healthData.red;function Vc({patientId:n=0}){const[e,t]=I.exports.useState();tn.info("realTimeHealthDataSocket: ",JSON.stringify(e));const{strokeRiskData:i}=qc({id:n,configs:{enabled:!!n}}),{t:r}=Je(["common","patients"]);I.exports.useEffect(()=>(Bt.listenRealtimeData(n,c=>{if(c){const p={blood_systolic:0,blood_diastolic:0,pulse:0,pulse_oxygenation:0,respiration:0,stress_monitor:0,fatigue_monitor:0,activity:0,sleep:0,stroke_risk:0};c.data.forEach(f=>{f.type===ge.blood_systolic&&(p.blood_systolic=Number(f.value)),f.type===ge.blood_diastolic&&(p.blood_diastolic=Number(f.value)),f.type===ge.pulse&&(p.pulse=Number(f.value)),f.type===ge.pulse_oxygenation&&(p.pulse_oxygenation=Number(f.value)),f.type===ge.respiration&&(p.respiration=Number(f.value)),f.type===ge.stress_monitor&&(p.stress_monitor=Number(f.value)),f.type===ge.fatigue_monitor&&(p.fatigue_monitor=Number(f.value)),f.type===ge.activity&&(p.activity=Number(f.value)),f.type===ge.sleep&&(p.sleep=Number((Number(f.value)/60).toFixed(2)))}),t(p)}}),()=>{Bt.removeListenRealtimeData(n)}),[n]);const s=I.exports.useMemo(()=>{var c,p;return[{Icon:Yr,params:`${i!=null?i:0}/5`,unit:"",title:r("common:socket_group.stroke_risk"),color:Uc(i!=null?i:0)},{Icon:Ki,params:(e==null?void 0:e.blood_systolic)&&(e==null?void 0:e.blood_diastolic)?`${e==null?void 0:e.blood_systolic}/${e==null?void 0:e.blood_diastolic}`:"",unit:"mmHg",title:r("common:socket_group.blood_pressure"),color:Wc((c=e==null?void 0:e.blood_systolic)!=null?c:0)},{Icon:$i,params:e==null?void 0:e.pulse_oxygenation,unit:"%",title:r("common:socket_group.oxygenation"),color:Hc((p=e==null?void 0:e.pulse_oxygenation)!=null?p:0)},{Icon:As,params:(e==null?void 0:e.pulse)||"",unit:"BPM",title:r("common:socket_group.pulse"),color:"#1EDB97"},{Icon:Ur,params:(e==null?void 0:e.respiration)||"-/-",unit:"RPM",title:r("common:socket_group.respiration"),color:"gray"},{Icon:Gi,params:e==null?void 0:e.activity,unit:"Steps",title:r("common:socket_group.step"),color:"#373C49"},{Icon:Zi,params:e==null?void 0:e.sleep,unit:"Hours",title:r("common:socket_group.sleep"),color:"primary"}]},[e,i,r]);return n?l(Yc,{healthParamsData:s}):l(Se,{children:"No data"})}const Xc=mt.memo(Vc),yl=()=>{var We,_e,Ce,tt,nt,Ne,it,A,O,Me,X,be,Q;const[n,e]=I.exports.useState(!0),{id:t}=Hr(),{t:i}=Je(["common","patients"]),r=Le(),{patientDetail:s,isLoading:c,refetch:p}=cs({id:Number(t),shouldNavigateNotFound:!0}),f=Ee({firstName:s==null?void 0:s.first_name,middleName:s==null?void 0:s.middle_name,lastName:s==null?void 0:s.last_name}),v=Ee({firstName:(We=s==null?void 0:s.doctor)==null?void 0:We.first_name,middleName:(_e=s==null?void 0:s.doctor)==null?void 0:_e.middle_name,lastName:(Ce=s==null?void 0:s.doctor)==null?void 0:Ce.last_name}),_=Ee({firstName:(tt=s==null?void 0:s.arnp)==null?void 0:tt.first_name,middleName:(nt=s==null?void 0:s.arnp)==null?void 0:nt.middle_name,lastName:(Ne=s==null?void 0:s.arnp)==null?void 0:Ne.last_name}),b=Wi(),k=I.exports.useMemo(()=>[{label:i("patients:list.patient_id"),text:s==null?void 0:s.special_id},{label:i("common:info.full_name"),text:f},{label:i("common:info.date_of_birth"),text:s==null?void 0:s.birthday},{label:i("common:info.gender"),text:String(s==null?void 0:s.gender)},{label:i("common:info.email_address"),text:s==null?void 0:s.email},{label:i("common:info.phone_number"),text:s==null?void 0:s.phone},{label:i("common:info.address"),text:Vi({city:s==null?void 0:s.city,state:s==null?void 0:s.state,street:s==null?void 0:s.street,country:s==null?void 0:s.country,zipCode:s==null?void 0:s.zip_code})},{label:i("common:info.zip_code"),text:String(s==null?void 0:s.zip_code)},{label:i("common:info.weight"),text:s!=null&&s.weight?`${String(s==null?void 0:s.weight)} (lbs)`:""},{label:i("common:info.height"),text:s!=null&&s.height?`${String(s==null?void 0:s.height)} (in)`:""}],[i,s,f]),T=I.exports.useMemo(()=>[{label:i("common:info.full_name"),text:s==null?void 0:s.emergency_name},{label:i("common:info.email_address"),text:s==null?void 0:s.emergency_email},{label:i("common:info.phone_number"),text:s==null?void 0:s.emergency_cellphone}],[s,i]),P=Rt(),w=Rt(),H=Nt(),ne=Nt(),W=Lt({schema:fs}),{reset:V,isDirtyField:G,getFieldState:$,getValues:Z}=W,j=ns(),z=es();function K(L){j.mutate(Pt({...L,id:s==null?void 0:s.user_id,birthday:ye({date:C(L.birthday),format:"YYYY-MM-DD"})}),{onSuccess(){r.refetchQueries([Y.LIST]),r.refetchQueries([Y.DETAIL,s==null?void 0:s.user_id]),p()}})}const[d,S]=I.exports.useState([]),y=I.exports.useCallback(L=>S(()=>L),[S]),m=ls();function M(){var Te;const L=(Te=s==null?void 0:s.id)!=null?Te:0;if(L){const he={patient_id:L};d.forEach((de,ut,Ve)=>{de.role===U.Doctor&&(he.doctor_id=de.id),de.role===U.ARNP&&(he.arnp_id=de.id),de.role===U.Doctor&&Ve.every(pe=>pe.role===U.Doctor)&&(he.doctor_id=de.id,he.arnp_id=0),de.role===U.ARNP&&Ve.every(pe=>pe.role===U.ARNP)&&(he.arnp_id=de.id,he.doctor_id=0)}),d.length||(he.arnp_id=0,he.doctor_id=0),m.mutate(he)}}const F=L=>e(L!==1),{checkAccess:N}=Un();return I.exports.useEffect(()=>{Bt.onSetEcho()},[]),E(Se,{children:[l(os,{title:f}),E(R,{direction:{base:"column-reverse",lg:"row"},spacing:{base:4,xl:6},align:"flex-start",children:[l(Co,{maxW:{base:"full",lg:n?"70%":"full"},children:l(is,{isLazy:!0,tabData:[{title:i("common:socket_group.patient_info").toUpperCase(),children:E(Se,{children:[l(at,{variant:"title",my:6,children:i("common:info.profile_information")}),l(Qe,{children:l(Qe.Card,{isLoaded:!c,noOfLines:4,children:l(ki,{infoData:k})})}),E(R,{borderTop:"1px",borderColor:"neutral.500",mt:6,children:[l(at,{variant:"title",my:6,children:i("common:info.emergency_contact")}),l(Qe,{children:l(Qe.Card,{isLoaded:!c,noOfLines:4,children:l(ki,{infoData:T})})})]})]})},N({allowedRoles:Wr})&&(s==null?void 0:s.special_id)&&{title:i("common:socket_group.health_data").toUpperCase(),children:E(Jr,{variant:"unstyled",isLazy:!0,children:[E(eo,{children:[l(Ei,{_selected:{color:"secondary"},px:0,sx:{fontWeight:"700",fontSize:{base:"18px",md:"20px"},lineHeight:"27px"},color:"neutral.400",children:i("common:socket_group.realtime_data")}),l(Ei,{_selected:{color:"secondary"},sx:{fontWeight:"700",fontSize:{base:"18px",md:"20px"},lineHeight:"27px"},color:"neutral.400",children:i("common:socket_group.actual_data")})]}),E(to,{children:[l(Si,{px:0,children:l(Xc,{patientId:s==null?void 0:s.id})}),l(Si,{px:0,children:l(Ic,{specialId:s==null?void 0:s.special_id,patientId:s==null?void 0:s.id})})]})]})},N({allowedRoles:Vr})&&(s==null?void 0:s.id)&&{title:i("common:socket_group.note"),children:l(Dc,{patientId:(it=s.id)!=null?it:0})}].filter(Boolean),onChangeTabs:F})}),n&&l(wo,{isLoading:!c,avatar:s==null?void 0:s.avatar,roleType:s!=null&&s.type?Ge[s.type]:"",location:"",title:f,children:E(R,{spacing:6,children:[E(R,{spacing:4,children:[E(R,{spacing:3,children:[(s==null?void 0:s.doctor)&&l(q,{color:"neutral.300",children:i("common:socket_group.assigned_doctor")}),(s==null?void 0:s.doctor)&&l(Ct,{_hover:N({allowedRoles:[U.Admin]})?{textDecor:"underline"}:{textDecor:"none",cursor:"default"},to:N({allowedRoles:[U.Admin]})?`${ft.CLINIC_TEAM}/${(A=s==null?void 0:s.doctor)==null?void 0:A.user_id}`:"",children:E(R,{align:"center",spacing:2,direction:"row",role:"group",children:[l($e,{src:(O=s.doctor)==null?void 0:O.avatar,w:10,h:10}),E(q,{_groupHover:{color:"primary"},children:[" ",v]})]})})]}),E(R,{spacing:3,children:[(s==null?void 0:s.arnp)&&E(q,{color:"neutral.300",children:[i("common:socket_group.assigned_arnp")," "]}),(s==null?void 0:s.arnp)&&l(Ct,{_hover:N({allowedRoles:[U.Admin]})?{textDecor:"underline"}:{textDecor:"none",cursor:"default"},to:N({allowedRoles:[U.Admin]})?`${ft.CLINIC_TEAM}/${(Me=s==null?void 0:s.arnp)==null?void 0:Me.user_id}`:"",children:E(R,{align:"center",spacing:2,direction:"row",role:"group",children:[l($e,{src:(X=s.arnp)==null?void 0:X.avatar,w:10,h:10}),l(q,{_groupHover:{color:"primary"},children:_})]})})]}),E(Ie,{allowedRoles:Xr,children:[l(re,{size:"lg",leftIcon:l(as,{}),w:"full",isDisabled:c,fontSize:"14px",onClick:()=>{var L;return(L=w.current)==null?void 0:L.openModal()},children:i("patients:form.assign_doctor/arnp_to_patient")}),l(Ot,{ref:w,title:i("patients:form.assign_doctor/arnp_to_patient"),isDone:m.isSuccess,renderFooter:()=>l(re,{w:"348px",size:"lg",type:"button",isLoading:m.isLoading,isDisabled:c,onClick:M,children:i("common:submit")}),children:l(ds,{patientId:(be=s==null?void 0:s.id)!=null?be:0,enabledGetUsers:(Q=w.current)==null?void 0:Q.isOpen,patientType:s==null?void 0:s.type,onAssignIds:y},"DoctorOrARNPToPatientCard")})]})]}),E(R,{children:[l(Ie,{allowedRoles:Cn,children:E(re,{variant:"ghost",size:"lg",fontSize:"14px",isDisabled:c,leftIcon:l(jr,{}),onClick:()=>{var L,Te;s&&V(Pt({...s,gender:Xi[s.gender],birthday:ye({date:s.birthday,format:"YYYY-MM-DD"}),emergency_cellphone:on(s.emergency_cellphone),device_id:(L=s==null?void 0:s.device)==null?void 0:L.id})),(Te=P.current)==null||Te.openModal()},children:[i("common:socket_group.edit_patient_profile"),s&&l(Ot,{ref:P,isDone:j.isSuccess,title:"Update Patient",renderFooter:()=>{var L;return l(re,{w:"348px",size:"lg",type:"submit",form:"update-patient",isLoading:j.isLoading,isDisabled:!G||j.isLoading&&!((L=ne.current)!=null&&L.isOpen)||c,children:i("common:submit")})},onBeforeClose:()=>{j.reset()},children:l(Mt,{form:W,id:"update-patient",onSubmit:L=>{var Te;if($("phone").isDirty||$("type").isDirty){(Te=ne.current)==null||Te.show();return}K(L)},children:l(Wn,{})})})]})}),l(Ie,{allowedRoles:Qi,children:E(re,{variant:"ghost",size:"lg",isDisabled:c,fontSize:"14px",leftIcon:l(ko,{}),onClick:()=>{var L;return(L=H.current)==null?void 0:L.show()},children:[i("common:socket_group.delete_patient"),s&&l(It,{ref:H,isLoading:z.isLoading,onHandleConfirm:()=>z.mutate(s==null?void 0:s.user_id,{onSuccess(){b(ft.PATIENTS_MANAGEMENT),r.removeQueries([Y.DETAIL,t]),r.refetchQueries([Y.LIST]),r.refetchQueries([an.LIST])}})})]})})]})]})}),l(It,{ref:ne,isDone:j.isSuccess,isLoading:j.isLoading,title:i("patients:form.update_confirm"),description:i("patients:form.are_you_sure_you_want_to_change_profile"),type:"info",textConfirm:i("common:save"),onHandleConfirm:()=>{const L=Z();K(L)}})]})]})};export{yl as PatientDetailPage,gl as PatientListPage};
